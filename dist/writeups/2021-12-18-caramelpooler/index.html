<!DOCTYPE html><html lang="en" data-astro-cid-dxom2xcl> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.18"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://localhost:3000/writeups/2021-12-18-caramelpooler/"><!-- Primary Meta Tags --><title>X-MAS CTF - CaramelPooler</title><meta name="title" content="X-MAS CTF - CaramelPooler"><meta name="description" content="Blockchain transaction data scraping"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://localhost:3000/writeups/2021-12-18-caramelpooler/"><meta property="og:title" content="X-MAS CTF - CaramelPooler"><meta property="og:description" content="Blockchain transaction data scraping"><meta property="og:image" content="https://localhost:3000/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://localhost:3000/writeups/2021-12-18-caramelpooler/"><meta property="twitter:title" content="X-MAS CTF - CaramelPooler"><meta property="twitter:description" content="Blockchain transaction data scraping"><meta property="twitter:image" content="https://localhost:3000/blog-placeholder-1.jpg"><style>:root{--accent: #fea819;--accent-dark: #ac7010;--accent-dark-010: #ac70100a}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-regular.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-bold.woff) format("woff");font-weight:700;font-style:normal;font-display:swap}body{font-family:Atkinson,sans-serif;margin:0;padding:0;text-align:left;background:#171717 no-repeat;background-size:100% 600px;word-wrap:break-word;overflow-wrap:break-word;color:#aaa;font-size:20px;line-height:1.25}main{width:720px;max-width:calc(100% - 2em);margin:auto;padding:3em 1em}h1,h2,h3,h4,h5,h6{margin:1em 0 .5rem;color:#fff;line-height:1.2}h1{font-size:3.052em}h2{font-size:2.441em}h3{font-size:1.953em}h4{font-size:1.563em}h5{font-size:1.25em}strong,b{font-weight:700}a,a:hover{color:var(--accent)}p{margin-bottom:1em}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%}img{max-width:100%;height:auto;border-radius:8px}code{padding:0 .3em;background-color:#1f1f1f;border-radius:.2em;font-size:.8em}pre{padding:1em;border-radius:.2em}pre>code{all:unset;font-size:.8em}blockquote{border-left:4px solid var(--accent);padding:.01em 0 .01em 1em;margin:0;background-color:var(--accent-dark-010)}hr{border:none;border-top:1px solid #e9e9e9}@media (max-width: 720px){body{font-size:18px}main{padding:1em}}.sr-only{border:0;padding:0;margin:0;position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap}a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#1f1f1f;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
main[data-astro-cid-dxom2xcl]{width:calc(100% - 2em);max-width:100%;margin:0}.hero-image[data-astro-cid-dxom2xcl]{width:100%}.hero-image[data-astro-cid-dxom2xcl] img[data-astro-cid-dxom2xcl]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-dxom2xcl]{width:75%;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-dxom2xcl]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-dxom2xcl] h1[data-astro-cid-dxom2xcl]{margin:0 0 .5em}.date[data-astro-cid-dxom2xcl]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-dxom2xcl]{font-style:italic}
</style></head> <body data-astro-cid-dxom2xcl> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <a href="/" style="padding: 1rem 0 0 0;" data-astro-cid-3ef6ksr2> <img src="/new_tower_logo.png" alt="Tower of Hanoi Logo" width="50rem" height="50rem" style="border-radius: 0;" data-astro-cid-3ef6ksr2> </a> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/blog" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blogposts </a>  <a href="/writeups" class="active" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Writeups </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://x.com/towerofhanoi" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Follow Tower of Hanoi on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://github.com/towerofhanoi" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Tower of Hanoi's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://ctftime.org/team/300" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Tower of Hanoi's CTF Time page</span> <svg viewBox="0 0 16 16" width="32" height="32" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M 0,0 H 16 V 16 H 0 L 4.7205698,7.7838485 Z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </nav> </header>  <main data-astro-cid-dxom2xcl> <article data-astro-cid-dxom2xcl> <div class="hero-image" data-astro-cid-dxom2xcl> <img width="720" height="360" src="/writeup_images/xmas21.png" alt="" data-astro-cid-dxom2xcl> </div> <div class="prose" data-astro-cid-dxom2xcl> <div class="title" data-astro-cid-dxom2xcl> <div class="date" data-astro-cid-dxom2xcl> <time datetime="2021-12-27T23:00:00.000Z"> Dec 28, 2021 </time>  </div> <h1 data-astro-cid-dxom2xcl>X-MAS CTF - CaramelPooler</h1> <h3 data-astro-cid-dxom2xcl> by Federico Villa</h3> <hr data-astro-cid-dxom2xcl> </div>  <h1 id="challenge-caramelpooler">Challenge: <strong>CaramelPooler</strong></h1>
<p>Description:</p>
<blockquote>
<p>Tokugawa shogunate cheated for a living. For that reason, you have to become shogun instead. Do it for Hideyoshi!<br>
nc challs.xmas.htsp.ro 8016<br>
<a href="http://challs.xmas.htsp.ro:8017/">http://challs.xmas.htsp.ro:8017/</a><br>
<a href="https://github.com/joswha/ethxmasctf2021/tree/main/caramelpool/contracts">Source</a></p>
</blockquote>
<h2 id="analizing-given-files">Analizing Given Files:</h2>
<p>At first we need to understand what the provided contracts make:</p>
<ul>
<li><strong><a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/Setup.sol">Setup.sol</a></strong> creates a new caramelPool contract passing it 10 ethereum addresses and also contain a <a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/Setup.sol#L30-L32">isSolved()</a> function that checks if a variable in CaramelPool is different from an address. Setup.isSolved() returning a True value means we solve the challenge.</li>
<li><strong><a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/CaramelPool.sol">CaramelPool.sol</a></strong> creates a certain number of tokens (total supply equal to 180000000) divided equally between ten addresses (the ten address provided during Setup.sol creation). The contract permits to tranfer those tokens between addresses (with the function <a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/CaramelPool.sol#L33-42">CaramelPool.transfer(fromAddress, toAddress)</a>), to fund the pool and then withdraw (with the functions <a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/CaramelPool.sol#L44-50">CaramelPool.fundPool(fromAddress)</a> and <a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/CaramelPool.sol#L52-58">CaramelPool.withdrawFromPool()</a>). There’s also a function to check the token balance of an address (CaramelPool.balanceOf(address)) and the <strong><a href="https://github.com/TowerofHanoi/towerofhanoi.github.io/tree/master/writeup_files/XMAS-CTF/CaramelPooler/CaramelPool.sol#L60-L64">becomeCaramelShogun()</a></strong> function, which checks if the balance of an address is equal to the total supply and, if so, turns that address into the <strong>Shogun</strong>. If the sender address is the Shogun, Setup.isSolved() returns true and the callenge is solved.<br>
Even if it is not of useful to the solution, the CaramelPool.sol also contains the private function isContract(address) which checks if an address is a contract for duration. Just for more information, the method by which it is checked whether an address is a contract or no, is easily bypassable with <a href="https://solidity-by-example.org/hacks/contract-size/">this</a> solution.</li>
</ul>
<p>To obtain these contracts and the blockchain used for the challenge, it is necessary to: <code>nc challs.xmas.htsp.ro 8016</code>. With this command it is possible, after selecting <em>launch new instance</em> and solving a short pow with <a href="https://it.wikipedia.org/wiki/Hashcash">hashcash</a>, to obtain: an RPC endpoint, the address of the Setup.sol contract, a private key and a uuid (useful for obtaining the flag at the end of the challenge).</p>
<h2 id="strategy">Strategy</h2>
<p>As you can understand from the analysis of the two contracts, all we have to do is <strong>transfer the tokens</strong> from the 10 addresses declared in Setup.sol to the sender address with the function CaramelPool.fundPool() and CaramelPool.withdrawFromPool().<br>
The problem lies in <strong>finding these 10 addresses</strong>.<br>
All data on the blockchain, due to its use as a publicly distributed ledger, is public and therefore visible to anyone.<br>
To retrieve all the data used by a particular contract when it was created and deployed, it is necessary to <strong>find the block and the transaction</strong> that generated it. From the input of the transaction it is possible to find out (in the form of bytecode) the data of the contract.</p>
<h2 id="retrieving-the-transaction-data">Retrieving the transaction data</h2>
<p>Fortunately for every blockchain instance of the challenge, the last block is the one in which the contracts were created. To retreive the transaction data in this contract is possible to create a python script using the <strong><a href="https://web3py.readthedocs.io/en/stable/">Web3.py</a> Python library</strong>.<br>
This library allows to interact with the Ethereum (and similar) blockchain. Here’s a <a href="https://web3py.readthedocs.io/en/stable/quickstart.html">quick reference</a> about how to install and use it.<br>
The python script must:</p>
<ol>
<li>connect with the given RPC endpoint</li>
<li>ask a node for the last block (which only contains the transaction of the generation of the challenge contracts)</li>
<li>access the transaction present in the last block</li>
<li>print the <strong>input of the transaction</strong></li>
</ol>
<p>Here’s the code:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> web3 </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> Web3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">url </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">INSERT_HERE_THE_RPC_ENDPOINT_URL_GIVEN</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#DBD7CAEE">provider </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">HTTPProvider</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">url</span><span style="color:#666666">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">blockNumber </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">block_number </span></span>
<span class="line"><span style="color:#DBD7CAEE">lastBlock </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">get_block</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">blockNumber</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">lastTransaction </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">get_transaction</span><span style="color:#666666">(</span><span style="color:#B8A965">str</span><span style="color:#666666">(((</span><span style="color:#DBD7CAEE">lastBlock</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">transactions</span><span style="color:#666666">)[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]).</span><span style="color:#DBD7CAEE">hex</span><span style="color:#666666">()))</span></span>
<span class="line"><span style="color:#B8A965">print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Last transaction input: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> lastTransaction</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">input</span><span style="color:#666666">)</span></span>
<span class="line"></span></code></pre>
<p>The code output is the following <strong>bytecode</strong>:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>0x608060405234801561001057600080fd5b506000600a67ffffffffffffffff811115610054577f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6040519080825280602002602001820160405280156100825781602001602082028036833780820191505090505b509050730136439830e1abe0296b764691eb3fc296d145bf816000815181106100d4577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073122e53f0444ac267371a0cf63d15cd782d8bb1c68160018151811061015d577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250506f219ab540356cbb839cbe05303d7705fa816002815181106101e2577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff1681525050734452552736041bcc3fe0f35647e56f2c4fdf956e8160038151811061026b577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250507201e0515bc0b5c2df1abc2842b42b29994f44d0816004815181106102f3577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250507397eebf4908c5c08eb09196579fc6451585d1b9a68160058151811061037c577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff1681525050731352cb6ccec784dd765ac55f0413cadfa4946cfd81600681518110610405577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250507314db6558f0dfcd940dae566c20f694d2f0454ca88160078151811061048e577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250507313182312eed5a75d62e45b726b63639b6a8f25bc81600881518110610517577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff1681525050731337cee91653179667c33affdbc28264c50c40b0816009815181106105a0577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff1681525050806040516105e790610653565b6105f191906106e5565b604051809103906000f08015801561060d573d6000803e3d6000fd5b506000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050610772565b610f6c80610a3283390190565b600061066c8383610678565b60208301905092915050565b61068181610740565b82525050565b600061069282610717565b61069c818561072f565b93506106a783610707565b8060005b838110156106d85781516106bf8882610660565b97506106ca83610722565b9250506001810190506106ab565b5085935050505092915050565b600060208201905081810360008301526106ff8184610687565b905092915050565b6000819050602082019050919050565b600081519050919050565b6000602082019050919050565b600082825260208201905092915050565b600061074b82610752565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6102b1806107816000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806364d98f6e1461003b578063dd62930314610059575b600080fd5b610043610077565b60405161005091906101cc565b60405180910390f35b61006161014c565b60405161006e91906101e7565b60405180910390f35b6000601373ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16634deb82256040518163ffffffff1660e01b815260040160206040518083038186803b1580156100f757600080fd5b505afa15801561010b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061012f9190610185565b73ffffffffffffffffffffffffffffffffffffffff161415905090565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008151905061017f81610264565b92915050565b60006020828403121561019757600080fd5b60006101a584828501610170565b91505092915050565b6101b781610214565b82525050565b6101c681610240565b82525050565b60006020820190506101e160008301846101ae565b92915050565b60006020820190506101fc60008301846101bd565b92915050565b600061020d82610220565b9050919050565b60008115159050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061024b82610252565b9050919050565b600061025d82610220565b9050919050565b61026d81610202565b811461027857600080fd5b5056fea264697066735822122032de8043eb101f00939d6e6153b5efe66761756956858822513c652ab115209464736f6c63430008000033608060405260006001556012600260006101000a81548160ff021916908360ff160217905550600260009054906101000a900460ff1660ff16600a62000046919062000314565b620f424062000056919062000314565b6003556013600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550348015620000a857600080fd5b5060405162000f6c38038062000f6c8339818101604052810190620000ce91906200026c565b60005b8151811015620001ab576000600260009054906101000a900460ff1660ff16600a620000fe919062000314565b620186a06200010e919062000314565b9050806000808585815181106200014e577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550508080620001a290620003b3565b915050620000d1565b505062000479565b6000620001ca620001c484620002e5565b620002b1565b90508083825260208201905082856020860282011115620001ea57600080fd5b60005b858110156200021e578162000203888262000228565b845260208401935060208301925050600181019050620001ed565b5050509392505050565b60008151905062000239816200045f565b92915050565b600082601f8301126200025157600080fd5b815162000263848260208601620001b3565b91505092915050565b6000602082840312156200027f57600080fd5b600082015167ffffffffffffffff8111156200029a57600080fd5b620002a8848285016200023f565b91505092915050565b6000604051905081810181811067ffffffffffffffff82111715620002db57620002da62000430565b5b8060405250919050565b600067ffffffffffffffff82111562000303576200030262000430565b5b602082029050602081019050919050565b60006200032182620003a9565b91506200032e83620003a9565b9250817fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff04831182151516156200036a576200036962000401565b5b828202905092915050565b6000620003828262000389565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b6000620003c082620003a9565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff821415620003f657620003f562000401565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6200046a8162000375565b81146200047657600080fd5b50565b610ae380620004896000396000f3fe608060405234801561001057600080fd5b50600436106100935760003560e01c80634deb8225116100665780634deb8225146100fa578063534844a2146101185780635b8ff0cf1461013657806370a0823114610140578063ba45b0b81461017057610093565b806318160ddd1461009857806326c0e5c5146100b6578063313ce567146100c05780633d61e543146100de575b600080fd5b6100a061018c565b6040516100ad9190610981565b60405180910390f35b6100be610192565b005b6100c8610271565b6040516100d5919061099c565b60405180910390f35b6100f860048036038101906100f3919061066e565b610284565b005b610102610371565b60405161010f91906108a6565b60405180910390f35b610120610397565b60405161012d9190610981565b60405180910390f35b61013e61039d565b005b61015a6004803603810190610155919061066e565b610463565b6040516101679190610981565b60405180910390f35b61018a60048036038101906101859190610697565b61047b565b005b60035481565b61019b33610646565b156101db576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101d290610921565b60405180910390fd5b6003546001541115610222576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161021990610961565b60405180910390fd5b6001546000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506000600181905550565b600260009054906101000a900460ff1681565b61028d33610646565b156102cd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102c490610901565b60405180910390fd5b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550806001600082825461036691906109c8565b925050819055505050565b600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60015481565b6003546000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541015610420576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610417906108c1565b60405180910390fd5b33600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b60006020528060005260406000206000915090505481565b8073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614156104ea576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104e190610941565b60405180910390fd5b8173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610558576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161054f906108e1565b60405180910390fd5b60008060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050600081116105a857600080fd5b60008060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550806000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461063a91906109c8565b92505081905550505050565b600080823b905060008111915050919050565b60008135905061066881610a96565b92915050565b60006020828403121561068057600080fd5b600061068e84828501610659565b91505092915050565b600080604083850312156106aa57600080fd5b60006106b885828601610659565b92505060206106c985828601610659565b9150509250929050565b6106dc81610a1e565b82525050565b60006106ef6039836109b7565b91507f596f7520646f6e2774206861766520656e6f75676820746f6b656e7320746f2060008301527f6265636f6d652074686520436172616d656c2053686f67756e000000000000006020830152604082019050919050565b6000610755601c836109b7565b91507f43616e206f6e6c792073656e642066726f6d20796f757273656c6621000000006000830152602082019050919050565b60006107956015836109b7565b91507f4e6f20636f6e74726163747a20616c6c6f7765642e00000000000000000000006000830152602082019050919050565b60006107d56020836109b7565b91507f596f752063616e27742077697468647261772066726f6d2074686520706f6f6c6000830152602082019050919050565b60006108156018836109b7565b91507f43616e6e6f742073656e6420746f20796f757273656c662100000000000000006000830152602082019050919050565b6000610855601a836109b7565b91507f446f6e27742074727920746f206861636b2074686520706f6f6c0000000000006000830152602082019050919050565b61089181610a50565b82525050565b6108a081610a5a565b82525050565b60006020820190506108bb60008301846106d3565b92915050565b600060208201905081810360008301526108da816106e2565b9050919050565b600060208201905081810360008301526108fa81610748565b9050919050565b6000602082019050818103600083015261091a81610788565b9050919050565b6000602082019050818103600083015261093a816107c8565b9050919050565b6000602082019050818103600083015261095a81610808565b9050919050565b6000602082019050818103600083015261097a81610848565b9050919050565b60006020820190506109966000830184610888565b92915050565b60006020820190506109b16000830184610897565b92915050565b600082825260208201905092915050565b60006109d382610a50565b91506109de83610a50565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115610a1357610a12610a67565b5b828201905092915050565b6000610a2982610a30565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600060ff82169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b610a9f81610a1e565b8114610aaa57600080fd5b5056fea264697066735822122074a092343e8d285c00cad1183aac813d54f28f902c2db35ed148fe5b7d4d119364736f6c63430008000033</span></span>
<span class="line"><span></span></span></code></pre>
<h2 id="analyze-bytecode">Analyze Bytecode</h2>
<p>To retrieve the 10 addresses used by the setup.sol contract all we need to do is analyze the bytecode.
For the analysis process we can get help from some tools like the <em><a href="https://github.com/crytic/pyevmasm">pyevmasm</a></em> library, with the useful <code>evmasm</code> command that permits to assemble or disassemble the Ethereum Virtual Machine bytecode.<br>
The addresses with the token are some of the correct addresses subject to a push operation (if an address is subject to a push 16 or 20 it should be padded with zeros). This work could also be done with some online disassembler like <em><a href="https://etherscan.io/opcode-tool">this</a></em> or more simply by noting that the bytecode has a <em>repetitive pattern</em> that isolates the 10 desired addresses:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>0x608060405234801561001057600080fd5b506000600a67ffffffffffffffff811115610054577f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6040519080825280602002602001820160405280156100825781602001602082028036833780820191505090505b50905073</span></span>
<span class="line"><span> ->   0136439830e1abe0296b764691eb3fc296d145bf</span></span>
<span class="line"><span>816000815181106100d4577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   122e53f0444ac267371a0cf63d15cd782d8bb1c6</span></span>
<span class="line"><span>8160018151811061015d577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250506f</span></span>
<span class="line"><span> ->   219ab540356cbb839cbe05303d7705fa 	#Address to be padded with zeros</span></span>
<span class="line"><span>816002815181106101e2577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   4452552736041bcc3fe0f35647e56f2c4fdf956e </span></span>
<span class="line"><span>8160038151811061026b577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505072</span></span>
<span class="line"><span> ->   01e0515bc0b5c2df1abc2842b42b29994f44d0 	#Address to be padded with zeros</span></span>
<span class="line"><span>816004815181106102f3577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   97eebf4908c5c08eb09196579fc6451585d1b9a6</span></span>
<span class="line"><span>8160058151811061037c577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   1352cb6ccec784dd765ac55f0413cadfa4946cfd</span></span>
<span class="line"><span>81600681518110610405577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   14db6558f0dfcd940dae566c20f694d2f0454ca8</span></span>
<span class="line"><span>8160078151811061048e577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   13182312eed5a75d62e45b726b63639b6a8f25bc</span></span>
<span class="line"><span>81600881518110610517577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073</span></span>
<span class="line"><span> ->   1337cee91653179667c33affdbc28264c50c40b0</span></span>
<span class="line"><span>816009815181106105a0577f4e487b710000000000000000000000000000000000000000000000000000000060005260...</span></span>
<span class="line"><span></span></span></code></pre>
<p>So the <strong>ten addresses</strong> are:</p>
<ol>
<li><em>0x0136439830e1abe0296b764691eb3fc296d145bf</em></li>
<li><em>0x122e53f0444ac267371a0cf63d15cd782d8bb1c6</em></li>
<li><em>0x00000000219ab540356cbb839cbe05303d7705fa</em></li>
<li><em>0x4452552736041bcc3fe0f35647e56f2c4fdf956e</em></li>
<li><em>0x0001e0515bc0b5c2df1abc2842b42b29994f44d0</em></li>
<li><em>0x97eebf4908c5c08eb09196579fc6451585d1b9a6</em></li>
<li><em>0x1352cb6ccec784dd765ac55f0413cadfa4946cfd</em></li>
<li><em>0x14db6558f0dfcd940dae566c20f694d2f0454ca8</em></li>
<li><em>0x13182312eed5a75d62e45b726b63639b6a8f25bc</em></li>
<li><em>0x1337cee91653179667c33affdbc28264c50c40b0</em></li>
</ol>
<h2 id="interacting-with-the-contract-and-becoming-shōgun">Interacting with the contract and becoming Shōgun</h2>
<p>After finding the ten addresses containing the desired tokens, it is necessary to interact with the CaramelPool.sol contract and arriving at a balance equal to the total token supply.
To interact with the blockchain we could both use the <strong>Web3.py</strong> python library or a web-based Solidity online IDE, <strong><a href="http://remix.ethereum.org/">Remix</a></strong>.<br>
With <strong>Remix IDE</strong> at first we have to upload the two contracts given in the <em>File Explorers</em> tab and compile them with the correct version of Solidity (in this case the 0.8.0) in the <em>Solidity Compiler</em> tab.<br>
Then we load the contracts in the <em>Deploy &#x26; Run Transactions</em> tab by connecting to the rpc endpoint given (switch the <em>Environment</em> to <em>Web3 Provider</em> giving the rpc endpoint link) and pasting the setup address in the <em>Load contract from Address</em> field.<br>
After this by clicking the <em>At Address</em> button we load the Setup.sol and then by calling the Setup.carmelPool() function (clicking the <em>caramelPool</em> button in the <em>Deployed Contracts</em> section) we can get the CaramelPool.sol address.<br>
After loading CaramelPool.sol contract and calling the <em>CaramelPool.fundPool(fromAddress)</em> function with the ten address found as a parameter we can have a withdram amount in the contract pool equal to the total supply. Then by calling the <em>CaramelPool.withdrawFromPool()</em> function and <em>CaramelPool.becomeCaramelShogun()</em> we can become the Shogun so if we call the <em>Setup.isSolved()</em> function we get a true value.</p>
<p>With <strong><a href="https://web3py.readthedocs.io/en/stable/">Web3.py</a></strong> Python library. All we have to do is to know a private key account, the rpc endpoint link, the Setup.sol contract address and the ABI of the two contracts.</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> web3 </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> Web3</span></span>
<span class="line"><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">url </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">INSERT_HERE_THE_RPC_ENDPOINT_URL_GIVEN</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#DBD7CAEE">provider </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">HTTPProvider</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">url</span><span style="color:#666666">))</span></span>
<span class="line"><span style="color:#DBD7CAEE">privateKey </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">INSERT_HERE_THE_PRIVATE_KEY_GIVEN</span><span style="color:#C98A7D77">'</span></span>
<span class="line"><span style="color:#DBD7CAEE">nonce </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">with</span><span style="color:#B8A965"> open</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">setup.json</span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span><span style="color:#4D9375"> as</span><span style="color:#DBD7CAEE"> f</span><span style="color:#666666">:</span><span style="color:#758575DD">       #json file with the contract ABI</span></span>
<span class="line"><span style="color:#DBD7CAEE">    setup_json </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> json</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">load</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">f</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">with</span><span style="color:#B8A965"> open</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">caramel.json</span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span><span style="color:#4D9375"> as</span><span style="color:#DBD7CAEE"> f</span><span style="color:#666666">:</span><span style="color:#758575DD">     #json file with the contract ABI</span></span>
<span class="line"><span style="color:#DBD7CAEE">    caramel_json </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> json</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">load</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">f</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">setupContract </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">toChecksumAddress</span><span style="color:#666666">(</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">INSERT_HERE_THE_SETUP_CONTRACT_ADDRESS_GIVEN</span><span style="color:#C98A7D77">'</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">setup </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">contract</span><span style="color:#666666">(</span><span style="color:#BD976A">address</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">setupContract</span><span style="color:#666666">,</span><span style="color:#BD976A"> abi</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> setup_json</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">caramelContract </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">toChecksumAddress</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">setup</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">functions</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">caramelPool</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">call</span><span style="color:#666666">())</span></span>
<span class="line"><span style="color:#DBD7CAEE">caramel </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">contract</span><span style="color:#666666">(</span><span style="color:#BD976A">address</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">caramelContract</span><span style="color:#666666">,</span><span style="color:#BD976A"> abi</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> caramel_json</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">addressesToken </span><span style="color:#666666">=</span><span style="color:#666666"> [</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">0x0136439830e1abe0296b764691eb3fc296d145bf</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x122e53f0444ac267371a0cf63d15cd782d8bb1c6</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x00000000219ab540356cbb839cbe05303d7705fa</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x4452552736041bcc3fe0f35647e56f2c4fdf956e</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x0001e0515bc0b5c2df1abc2842b42b29994f44d0</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x97eebf4908c5c08eb09196579fc6451585d1b9a6</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x1352cb6ccec784dd765ac55f0413cadfa4946cfd</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x14db6558f0dfcd940dae566c20f694d2f0454ca8</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x13182312eed5a75d62e45b726b63639b6a8f25bc</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                    '</span><span style="color:#C98A7D">0x1337cee91653179667c33affdbc28264c50c40b0</span><span style="color:#C98A7D77">'</span><span style="color:#666666">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> addressTarget </span><span style="color:#4D9375">in</span><span style="color:#DBD7CAEE"> addressesToken</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">    transaction </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> caramel</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">functions</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">fundPool</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">toChecksumAddress</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">addressTarget</span><span style="color:#666666">)).</span><span style="color:#DBD7CAEE">buildTransaction</span><span style="color:#666666">({</span></span>
<span class="line"><span style="color:#C98A7D77">        '</span><span style="color:#C98A7D">gas</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#4C9A91"> 70000</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">        '</span><span style="color:#C98A7D">gasPrice</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">toWei</span><span style="color:#666666">(</span><span style="color:#4C9A91">40</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">gwei</span><span style="color:#C98A7D77">'</span><span style="color:#666666">),</span><span style="color:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#C98A7D77">        '</span><span style="color:#C98A7D">nonce</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#DBD7CAEE"> nonce</span><span style="color:#666666">})</span></span>
<span class="line"><span style="color:#DBD7CAEE">    signed_txn </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">account</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">signTransaction</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">transaction</span><span style="color:#666666">,</span><span style="color:#BD976A"> private_key</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">privateKey</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    provider</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">eth</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendRawTransaction</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">signed_txn</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">rawTransaction</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    nonce </span><span style="color:#666666">+=</span><span style="color:#4C9A91"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">transaction </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> caramel</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">functions</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">withdrawFromPool</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">buildTransaction</span><span style="color:#666666">({</span></span>
<span class="line"><span style="color:#C98A7D77">    '</span><span style="color:#C98A7D">gas</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#4C9A91"> 70000</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">    '</span><span style="color:#C98A7D">gasPrice</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">toWei</span><span style="color:#666666">(</span><span style="color:#4C9A91">40</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">gwei</span><span style="color:#C98A7D77">'</span><span style="color:#666666">),</span><span style="color:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#C98A7D77">    '</span><span style="color:#C98A7D">nonce</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#DBD7CAEE"> nonce</span></span>
<span class="line"><span style="color:#666666">})</span><span style="color:#758575DD">      #Withdraw all the token to the sender address</span></span>
<span class="line"><span style="color:#DBD7CAEE">nonce </span><span style="color:#666666">+=</span><span style="color:#4C9A91"> 1</span></span>
<span class="line"><span style="color:#DBD7CAEE">transaction </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> caramel</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">functions</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">becomeCaramelShogun</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">buildTransaction</span><span style="color:#666666">({</span></span>
<span class="line"><span style="color:#C98A7D77">    '</span><span style="color:#C98A7D">gas</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#4C9A91"> 70000</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">    '</span><span style="color:#C98A7D">gasPrice</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#DBD7CAEE"> Web3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">toWei</span><span style="color:#666666">(</span><span style="color:#4C9A91">40</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">gwei</span><span style="color:#C98A7D77">'</span><span style="color:#666666">),</span><span style="color:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#C98A7D77">    '</span><span style="color:#C98A7D">nonce</span><span style="color:#C98A7D77">'</span><span style="color:#666666">:</span><span style="color:#DBD7CAEE"> nonce</span></span>
<span class="line"><span style="color:#666666">})</span><span style="color:#758575DD">      #Now the sender address is the caramel Shogun </span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965">print</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">setup</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">functions</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">isSolved</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">call</span><span style="color:#666666">())</span></span>
<span class="line"></span></code></pre>
<h2 id="retrieving-the-flag">Retrieving the flag</h2>
<p>After the <em>Setup.isSolved()</em> function returned a <em>True</em> value we can get the flag by connect to the challenge server with <code>nc challs.xmas.htsp.ro 8016</code>, selecting <em>get flag</em> and inserting the uuid given at the beginning of the challenge.</p>
<p>Turns out that the flag was:
<code>X-MAS{G00d_j0b_y0u_4r3_Hideyoshis_h31r}</code></p>  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2024 Tower of Hanoi. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://twitter.com/towerofhanoi" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Tower of Hanoi on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/towerofhanoi" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Tower of Haoi's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://ctftime.org/team/300" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Tower of Hanoi's CTF Time page</span> <svg viewBox="0 0 16 16" width="32" height="32" data-astro-cid-sz7xmlte> <path fill="currentColor" d="M 0,0 H 16 V 16 H 0 L 4.7205698,7.7838485 Z" data-astro-cid-sz7xmlte></path> </svg> </a> </div> </footer>  </body></html>