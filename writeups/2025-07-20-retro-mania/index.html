<!DOCTYPE html><html lang="en" data-astro-cid-dxom2xcl> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon-dark.svg" media="(prefers-color-scheme: light)"><link rel="icon" type="image/svg+xml" href="/favicon.svg" media="(prefers-color-scheme: dark)"><meta name="generator" content="Astro v4.16.18"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://towerofhanoi.it/writeups/2025-07-20-retro-mania/"><!-- Primary Meta Tags --><title>ToH CTF 2025 - Retro Mania</title><meta name="title" content="ToH CTF 2025 - Retro Mania"><meta name="description" content="Official writeup for the ToH CTF 2025 challenge &#34;Retro Mania&#34;"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://towerofhanoi.it/writeups/2025-07-20-retro-mania/"><meta property="og:title" content="ToH CTF 2025 - Retro Mania"><meta property="og:description" content="Official writeup for the ToH CTF 2025 challenge &#34;Retro Mania&#34;"><meta property="og:image" content="https://towerofhanoi.it/writeup_images/retro-mania.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://towerofhanoi.it/writeups/2025-07-20-retro-mania/"><meta property="twitter:title" content="ToH CTF 2025 - Retro Mania"><meta property="twitter:description" content="Official writeup for the ToH CTF 2025 challenge &#34;Retro Mania&#34;"><meta property="twitter:image" content="https://towerofhanoi.it/writeup_images/retro-mania.png"><style>:root{--accent: #fea819;--accent-dark: #ac7010;--accent-dark-010: #ac70100a}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-regular.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-bold.woff) format("woff");font-weight:700;font-style:normal;font-display:swap}body{font-family:Atkinson,sans-serif;margin:0;padding:0;text-align:left;background:#171717 no-repeat;background-size:100% 600px;word-wrap:break-word;overflow-wrap:break-word;color:#aaa;font-size:20px;line-height:1.25}main{width:720px;max-width:calc(100% - 2em);margin:auto;padding:3em 1em}h1,h2,h3,h4,h5,h6{margin:1em 0 .5rem;color:#fff;line-height:1.2}h1{font-size:3.052em}h2{font-size:2.441em}h3{font-size:1.953em}h4{font-size:1.563em}h5{font-size:1.25em}strong,b{font-weight:700}a,a:hover{color:var(--accent)}p{margin-bottom:1em}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%}img{max-width:100%;height:auto;border-radius:8px}code{padding:0 .3em;background-color:#1f1f1f;border-radius:.2em;font-size:.8em}pre{padding:1em;border-radius:.2em}pre>code{all:unset;font-size:.8em}blockquote{border-left:4px solid var(--accent);padding:.01em 0 .01em 1em;margin:0;background-color:var(--accent-dark-010)}hr{border:none;border-top:1px solid #e9e9e9}@media (max-width: 720px){body{font-size:18px}main{padding:1em}}.sr-only{border:0;padding:0;margin:0;position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap}table{border-collapse:collapse;text-align:center}tr{border:1px solid #e9e9e9}th,td{padding:.5em;text-align:center}th{background-color:#1f1f1f;color:#fff}td{background-color:#1b1b1b}a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#1f1f1f;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
@media (prefers-color-scheme: dark){.markdown-alert{--color-border-default: #30363d;--color-accent-fg: #58a6ff;--color-accent-emphasis: #1f6feb;--color-danger-fg: #f85149;--color-danger-emphasis: #da3633;--color-attention-fg: #d29922;--color-attention-emphasis: #9e6a03;--color-done-fg: #a371f7;--color-done-emphasis: #8957e5;--color-success-fg: #3fb950;--color-success-emphasis: #238636}}@media (prefers-color-scheme: light){.markdown-alert{--color-border-default: #d0d7de;--color-accent-fg: #0969da;--color-accent-emphasis: #0969da;--color-danger-fg: #d1242f;--color-danger-emphasis: #cf222e;--color-attention-fg: #9a6700;--color-attention-emphasis: #9a6700;--color-done-fg: #8250df;--color-done-emphasis: #8250df;--color-success-fg: #1a7f37;--color-success-emphasis: #1f883d}}.markdown-alert{border-left:.25em solid var(--borderColor-default, var(--color-border-default));color:inherit;margin-bottom:16px;padding:.5rem 1em}.markdown-alert>:last-child{margin-bottom:0!important}.markdown-alert .markdown-alert-title{align-items:center;display:flex;font-size:14px;font-weight:500;line-height:1}.markdown-alert .markdown-alert-title svg.octicon{margin-right:8px!important;margin-right:var(--base-size-8,8px)!important;fill:currentColor}.markdown-alert.markdown-alert-note{border-left-color:var(--borderColor-accent-emphasis,var(--color-accent-emphasis))}.markdown-alert.markdown-alert-note .markdown-alert-title{color:var(--color-accent-fg);color:var(--fgColor-accent,var(--color-accent-fg))}.markdown-alert.markdown-alert-tip{border-left-color:var(--borderColor-success-emphasis,var(--color-success-emphasis))}.markdown-alert.markdown-alert-tip .markdown-alert-title{color:var(--color-success-fg);color:var(--fgColor-success,var(--color-success-fg))}.markdown-alert.markdown-alert-important{border-left-color:var(--borderColor-done-emphasis,var(--color-done-emphasis))}.markdown-alert.markdown-alert-important .markdown-alert-title{color:var(--color-done-fg);color:var(--fgColor-done,var(--color-done-fg))}.markdown-alert.markdown-alert-warning{border-left-color:var(--borderColor-attention-emphasis,var(--color-attention-emphasis))}.markdown-alert.markdown-alert-warning .markdown-alert-title{color:var(--color-attention-fg);color:var(--fgColor-attention,var(--color-attention-fg))}.markdown-alert.markdown-alert-caution{border-left-color:var(--borderColor-danger-emphasis,var(--color-danger-emphasis))}.markdown-alert.markdown-alert-caution .markdown-alert-title{color:var(--color-danger-fg);color:var(--fgColor-danger,var(--color-danger-fg))}main[data-astro-cid-dxom2xcl]{width:calc(100% - 2em);max-width:100%;margin:0}.hero-image[data-astro-cid-dxom2xcl]{width:100%}.hero-image[data-astro-cid-dxom2xcl] img[data-astro-cid-dxom2xcl]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-dxom2xcl]{width:75%;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-dxom2xcl]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-dxom2xcl] h1[data-astro-cid-dxom2xcl]{margin:0 0 .5em}.date[data-astro-cid-dxom2xcl]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-dxom2xcl]{font-style:italic}
</style></head> <body data-astro-cid-dxom2xcl> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <a href="/" style="padding: 1rem 0 0 0;" data-astro-cid-3ef6ksr2> <img src="/new_tower_logo.png" alt="Tower of Hanoi Logo" width="50rem" height="50rem" style="border-radius: 0;" data-astro-cid-3ef6ksr2> </a> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/blog" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blogposts </a>  <a href="/writeups" class="active" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Writeups </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://x.com/towerofhanoi" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Follow Tower of Hanoi on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://github.com/towerofhanoi" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Tower of Hanoi's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://ctftime.org/team/300" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Tower of Hanoi's CTF Time page</span> <svg viewBox="0 0 16 16" width="32" height="32" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M 0,0 H 16 V 16 H 0 L 4.7205698,7.7838485 Z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </nav> </header>  <main data-astro-cid-dxom2xcl> <article data-astro-cid-dxom2xcl> <div class="hero-image" data-astro-cid-dxom2xcl> <img width="720" height="360" src="/writeup_images/retro-mania.png" alt="" data-astro-cid-dxom2xcl> </div> <div class="prose" data-astro-cid-dxom2xcl> <div class="title" data-astro-cid-dxom2xcl> <div class="date" data-astro-cid-dxom2xcl> <time datetime="2025-07-20T16:00:00.000Z"> Jul 20, 2025 </time>  </div> <h1 data-astro-cid-dxom2xcl>ToH CTF 2025 - Retro Mania</h1> <h3 data-astro-cid-dxom2xcl> by Frank01001</h3> <hr data-astro-cid-dxom2xcl> </div>  <p><img src="/writeup_files/retro-mania/final_retro_mania.jpeg" alt="BoxArt"></p>
<blockquote>
<p>Hey guys. So, I was digging around in my basement and found this super old GBA game from when I was a kid. Total nostalgia trip. BUT, here’s the problem: I can’t find the manual, and it had the instructions for the anti-piracy check. 😭 Tried to fire it up on my GBA, but it ain’t budging. Anyone know how to get past this? I’ve got the ROM file here if anyone wants to take a look. Help an old gamer out!</p>
</blockquote>
<h2 id="description">Description</h2>
<p>You are presented with a GBA ROM file that includes an anti-piracy check. Solve the sequence checker to retrieve the flag. Basically, it is a traditional crackme challenge.</p>
<h2 id="analysis">Analysis</h2>
<p>Let’s load the ROM into an emulator (like mGBA) to see what happens.</p>
<p>Upon launching the game, we’re greeted with a title screen, telling us to press Start to begin. This is not just a nostalgic trip; it also sets the stage for the anti-piracy check that follows. The game saves the index of the frame where the player pressed Start, which will be used for “randomization” later.</p>
<p><img src="/writeup_files/retro-mania/menu.png" alt="Menu"></p>
<p>After pressing start, we meet John the Genie, a friendly character who asks us for proof that we own the game.</p>
<p><img src="/writeup_files/retro-mania/john_the_genie.png" alt="John the Genie"></p>
<p>He prompts us to open a page from the game manual, which contains a unique symbolic code. As I mentioned before, the requested page is “randomized” based on the frame index where we pressed Start. In fact, when running the game multiple times, it is highly likely that the page number will change each time.</p>
<p><img src="/writeup_files/retro-mania/page21.png" alt="Page21">
<img src="/writeup_files/retro-mania/page35.png" alt="Page35"></p>
<p>The following is the code snippet that handles the “randomization” of the page number:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> pageIndex </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> num_frames_start_press </span><span style="color:#CB7676">%</span><span style="color:#4C9A91"> 8</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> randomizedPage </span><span style="color:#666666">=</span><span style="color:#BD976A"> possible_pages</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">pageIndex</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#CB7676">char</span><span style="color:#BD976A"> randomizedPageStr</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#80A665">sprintf</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">randomizedPageStr</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C99076">%d</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> randomizedPage</span><span style="color:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665">tte_erase_line</span><span style="color:#666666">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665">tte_set_pos</span><span style="color:#666666">(</span><span style="color:#4C9A91">10</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">tte_write</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Go get the manual and enter the code on page </span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">tte_write</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">randomizedPageStr</span><span style="color:#666666">);</span></span>
<span class="line"></span></code></pre>
<p>In total, there are 8 possible pages that the game can request.</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#CB7676">const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> possible_pages</span><span style="color:#CB7676">[]</span><span style="color:#666666"> =</span><span style="color:#666666"> {</span><span style="color:#4C9A91">18</span><span style="color:#666666">,</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#4C9A91">21</span><span style="color:#666666">,</span><span style="color:#4C9A91">23</span><span style="color:#666666">,</span><span style="color:#4C9A91">25</span><span style="color:#666666">,</span><span style="color:#4C9A91">33</span><span style="color:#666666">,</span><span style="color:#4C9A91">34</span><span style="color:#666666">,</span><span style="color:#4C9A91">35</span><span style="color:#666666">};</span></span>
<span class="line"></span></code></pre>
<p>After John’s greeting, the game presents you with a selector to enter the sequence of 7 symbols from the manual page. The selector is a simple interface where you can choose the symbols one by one. You interact with the ↑ and ↓ buttons to navigate through the symbols, and the Start button to confirm the code.</p>
<p><img src="/writeup_files/retro-mania/selector.png" alt="Selector"></p>
<p>From an inspection of sprites contained in the ROM (or from exploring the game directly), we can see that the number of symbols is 26. So…is bruteforcing an option? Well, not quite.</p>
<p><img src="/writeup_files/retro-mania/obj_16.png" alt="Symbols"></p>
<p>For reference, these are the indices of each symbol, which will come in handy later:</p>
<p><img src="/writeup_files/retro-mania/indices.png" alt="Symbols2"></p>
<p>You would have to guess 26^7 combinations, which is a whopping 8031810176 attempts ≈ 33 bits of entropy. You clearly can’t do that from the emulator alone, since it would take a lifetime to try all possible combinations. Even if you attempted a brute-force approach, you would first need to identify the flag-checking logic in the ROM and run it multiple times, by which point you would likely have already discovered the logic behind the anti-piracy check.</p>
<h2 id="solution">Solution</h2>
<p>There are many ways to avoid having to reverse the whole ROM. The first is to look around the code for interesting functions. The other is to use the debugger included in most GBA emulators, such as mGBA. I find mGBA particularly handy, since it exposes a GDBServer to which you can connect. If you are used to tools like pwndbg or gef, you will feel right at home.</p>
<p>We need to identify two functions: a utility of the sequence checker and the sequence checker itself. The following is the sorce code for both:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#CB7676">char</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> char</span><span style="color:#BD976A"> block</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">{</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> char</span><span style="color:#DBD7CAEE"> parity </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#666666">(</span><span style="color:#CB7676">int</span><span style="color:#DBD7CAEE"> i </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 8</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i</span><span style="color:#CB7676">++</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">    {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        parity </span><span style="color:#CB7676">^=</span><span style="color:#DBD7CAEE"> block </span><span style="color:#CB7676">&#x26;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">        block </span><span style="color:#CB7676">>>=</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> parity</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">bool</span><span style="color:#80A665"> isLicenceCorrect</span><span style="color:#666666">(</span><span style="color:#CB7676">const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> char*</span><span style="color:#BD976A"> licence</span><span style="color:#666666">,</span><span style="color:#CB7676"> const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> char</span><span style="color:#BD976A"> pageNumber</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">{</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#CB7676"> ||</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#CB7676"> ||</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#CB7676"> ||</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#CB7676"> ||</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#CB7676"> ||</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#CB7676"> ||</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> ></span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">        return</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    // Modular multiplication check</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> numberOne </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">10000</span><span style="color:#666666">)</span><span style="color:#CB7676"> >></span><span style="color:#4C9A91"> 4</span><span style="color:#CB7676"> |</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#CB7676"> |</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;&#x3C;</span><span style="color:#4C9A91"> 6</span><span style="color:#CB7676"> |</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;&#x3C;</span><span style="color:#4C9A91"> 11</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> numberTwo </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">00001</span><span style="color:#666666">)</span><span style="color:#CB7676"> |</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#CB7676"> |</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;&#x3C;</span><span style="color:#4C9A91"> 6</span><span style="color:#CB7676"> |</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;&#x3C;</span><span style="color:#4C9A91"> 11</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> firstCheck </span><span style="color:#666666">=</span><span style="color:#666666"> ((</span><span style="color:#DBD7CAEE">numberOne </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE"> numberTwo</span><span style="color:#666666">))</span><span style="color:#CB7676"> %</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">abc</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">firstCheck </span><span style="color:#CB7676">!=</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">        return</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    // Parity check</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> char</span><span style="color:#DBD7CAEE"> totalParityGroup1 </span><span style="color:#666666">=</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">])</span><span style="color:#CB7676"> ^</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">])</span><span style="color:#CB7676"> ^</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">]);</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> char</span><span style="color:#DBD7CAEE"> totalParityGroup2 </span><span style="color:#666666">=</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">])</span><span style="color:#CB7676"> ^</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">])</span><span style="color:#CB7676"> ^</span><span style="color:#80A665"> parityCheck</span><span style="color:#666666">(</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> char</span><span style="color:#DBD7CAEE"> flipBit </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">01000</span><span style="color:#666666">)</span><span style="color:#CB7676"> >></span><span style="color:#4C9A91"> 3</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> char</span><span style="color:#DBD7CAEE"> correctParity1 </span><span style="color:#666666">=</span><span style="color:#666666"> ((</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">00010</span><span style="color:#666666">)</span><span style="color:#CB7676"> >></span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#CB7676"> ^</span><span style="color:#DBD7CAEE"> flipBit</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> char</span><span style="color:#DBD7CAEE"> correctParity2 </span><span style="color:#666666">=</span><span style="color:#666666"> ((</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">00100</span><span style="color:#666666">)</span><span style="color:#CB7676"> >></span><span style="color:#4C9A91"> 2</span><span style="color:#666666">)</span><span style="color:#CB7676"> ^</span><span style="color:#DBD7CAEE"> flipBit</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">totalParityGroup1 </span><span style="color:#CB7676">!=</span><span style="color:#DBD7CAEE"> correctParity1 </span><span style="color:#CB7676">||</span><span style="color:#DBD7CAEE"> totalParityGroup2 </span><span style="color:#CB7676">!=</span><span style="color:#DBD7CAEE"> correctParity2</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">        return</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    // Other arithmetic checks</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666">(((</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">])</span><span style="color:#CB7676"> !=</span><span style="color:#666666"> (</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">11</span><span style="color:#666666">))</span><span style="color:#CB7676"> ||</span><span style="color:#666666"> ((</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">])</span><span style="color:#CB7676"> !=</span><span style="color:#666666"> (</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">12</span><span style="color:#666666">)))</span></span>
<span class="line"><span style="color:#4D9375">        return</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666">((</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">])</span><span style="color:#CB7676"> !=</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">11111</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">        return</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    // Page check</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666">((</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#666666">)</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> +</span><span style="color:#666666"> (</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#666666">)</span><span style="color:#BD976A"> licence</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">]</span><span style="color:#CB7676"> !=</span><span style="color:#DBD7CAEE"> pageNumber</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">        return</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>The checks themself are not too complicated, but depending on how you approach the reversing task, they may be difficult to spot. The first function, <code>parityCheck</code>, calculates the parity of a byte, which is used later in the sequence checker. The second function, <code>isLicenceCorrect</code>, performs several checks on the input sequence to verify its validity. For each page number, the function has only one solution, meaning we can use solvers like <a href="https://ericpony.github.io/z3py-tutorial/guide-examples.htm">z3</a> to find the correct sequence for each page.</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="py"><code><span class="line"><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> z3</span></span>
<span class="line"><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> math</span></span>
<span class="line"><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">def</span><span style="color:#80A665"> pad_zeros</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">binary_string</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> desired_length</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">'</span><span style="color:#CB7676"> *</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">desired_length </span><span style="color:#CB7676">-</span><span style="color:#B8A965"> len</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">binary_string</span><span style="color:#666666">))</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> binary_string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">argc </span><span style="color:#666666">=</span><span style="color:#B8A965"> len</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">sys</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">argv</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">argv </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> sys</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">argv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> argc </span><span style="color:#CB7676">!=</span><span style="color:#4C9A91"> 2</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">'Usage: </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">argv</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#C99076">}</span><span style="color:#C98A7D"> &#x3C;page_number>'</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    sys</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">exit</span><span style="color:#666666">(</span><span style="color:#4C9A91">1</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">try</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">    chosen_page </span><span style="color:#666666">=</span><span style="color:#B8A965"> int</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">argv</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">])</span></span>
<span class="line"><span style="color:#4D9375">except</span><span style="color:#B8A965"> ValueError</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">'Invalid page number: </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">argv</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">]</span><span style="color:#C99076">}</span><span style="color:#C98A7D">'</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    sys</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">exit</span><span style="color:#666666">(</span><span style="color:#4C9A91">1</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">def</span><span style="color:#80A665"> compute_parity</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">bitvec</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#DBD7CAEE">    parity </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">bitvec</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">size</span><span style="color:#666666">()):</span></span>
<span class="line"><span style="color:#DBD7CAEE">        parity </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> parity </span><span style="color:#CB7676">^</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> i</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> bitvec</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> parity</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">p </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">BitVecVal</span><span style="color:#666666">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">abc</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 32</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965">input</span><span style="color:#666666"> =</span><span style="color:#666666"> [</span><span style="color:#DBD7CAEE">z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">BitVec</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">'x_</span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">i</span><span style="color:#C99076">}</span><span style="color:#C98A7D">'</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">)</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">7</span><span style="color:#666666">)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># Solve for the seed given random_long = user_input</span></span>
<span class="line"><span style="color:#DBD7CAEE">s </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Solver</span><span style="color:#666666">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">7</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#DBD7CAEE">    s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">UGE</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">],</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">),</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ULT</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">],</span><span style="color:#4C9A91"> 26</span><span style="color:#666666">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">most_significant_of_last </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#4C9A91">4</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 4</span><span style="color:#666666">,</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">])</span></span>
<span class="line"><span style="color:#DBD7CAEE">least_significant_of_last </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">remaining_bits_of_last </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#4C9A91">3</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">correct_parity_of_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> remaining_bits_of_last</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">correct_parity_of_2 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#4C9A91">1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> remaining_bits_of_last</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">flip_bit </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Extract</span><span style="color:#666666">(</span><span style="color:#4C9A91">2</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> remaining_bits_of_last</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># Check that the second number is the modular inverse of the first number</span></span>
<span class="line"><span style="color:#DBD7CAEE">first_number </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Concat</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">],</span><span style="color:#DBD7CAEE"> most_significant_of_last</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">second_number </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Concat</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">],</span><span style="color:#DBD7CAEE"> least_significant_of_last</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># Zero extension to avoid overflow</span></span>
<span class="line"><span style="color:#DBD7CAEE">first_number </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ZeroExt</span><span style="color:#666666">(</span><span style="color:#4C9A91">16</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> first_number</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">second_number </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ZeroExt</span><span style="color:#666666">(</span><span style="color:#4C9A91">16</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> second_number</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">product </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">first_number </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE"> second_number</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">first_number </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE"> second_number</span><span style="color:#666666">)</span><span style="color:#CB7676"> %</span><span style="color:#DBD7CAEE"> p </span><span style="color:#CB7676">==</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># Check for parity</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">parity_group_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Concat</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">])</span></span>
<span class="line"><span style="color:#DBD7CAEE">parity_group_2 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Concat</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">],</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">parity_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> compute_parity</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">parity_group_1</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">parity_2 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> compute_parity</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">parity_group_2</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">parity_1 </span><span style="color:#CB7676">==</span><span style="color:#DBD7CAEE"> correct_parity_of_1 </span><span style="color:#CB7676">^</span><span style="color:#DBD7CAEE"> flip_bit</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">parity_2 </span><span style="color:#CB7676">==</span><span style="color:#DBD7CAEE"> correct_parity_of_2 </span><span style="color:#CB7676">^</span><span style="color:#DBD7CAEE"> flip_bit</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">]</span><span style="color:#CB7676"> ==</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c171</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x26;</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">4</span><span style="color:#666666">]</span><span style="color:#CB7676"> ==</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">5</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a7f2</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># First bit of every element of the input is the opposite of the last bit of the previous element</span></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">]</span><span style="color:#CB7676"> ==</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">BitVecVal</span><span style="color:#666666">(</span><span style="color:#CB7676">0b</span><span style="color:#4C9A91">11111</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">x_0_ext </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ZeroExt</span><span style="color:#666666">(</span><span style="color:#4C9A91">3</span><span style="color:#666666">,</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">])</span></span>
<span class="line"><span style="color:#DBD7CAEE">x_1_ext </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ZeroExt</span><span style="color:#666666">(</span><span style="color:#4C9A91">3</span><span style="color:#666666">,</span><span style="color:#B8A965"> input</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">x_0_ext </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> x_1_ext </span><span style="color:#CB7676">==</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">BitVecVal</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">chosen_page</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 8</span><span style="color:#666666">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">count </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span></span>
<span class="line"><span style="color:#4D9375">while</span><span style="color:#DBD7CAEE"> s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">()</span><span style="color:#CB7676"> ==</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sat</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">    count </span><span style="color:#666666">+=</span><span style="color:#4C9A91"> 1</span></span>
<span class="line"><span style="color:#DBD7CAEE">    model </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">model</span><span style="color:#666666">()</span></span>
<span class="line"><span style="color:#758575DD">    # Create a new constraint that blocks the current model</span></span>
<span class="line"><span style="color:#DBD7CAEE">    block </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> z3</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Or</span><span style="color:#666666">([</span><span style="color:#DBD7CAEE">var</span><span style="color:#666666">()</span><span style="color:#CB7676"> !=</span><span style="color:#DBD7CAEE"> model</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">var</span><span style="color:#666666">]</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> var </span><span style="color:#4D9375">in</span><span style="color:#DBD7CAEE"> model</span><span style="color:#666666">])</span></span>
<span class="line"><span style="color:#DBD7CAEE">    s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">block</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">Found a solution</span><span style="color:#C98A7D77">'</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">7</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#B8A965">        print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">x_</span><span style="color:#C99076">{}</span><span style="color:#C98A7D"> = </span><span style="color:#C99076">{}</span><span style="color:#C98A7D77">'</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">format</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> model</span><span style="color:#666666">[</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]]))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">'Sum of first two numbers: </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">model</span><span style="color:#666666">[</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]].</span><span style="color:#DBD7CAEE">as_long</span><span style="color:#666666">()</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> model</span><span style="color:#666666">[</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#4C9A91">1</span><span style="color:#666666">]].</span><span style="color:#DBD7CAEE">as_long</span><span style="color:#666666">()</span><span style="color:#C99076">}</span><span style="color:#C98A7D">'</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    # Print the binary representation of all chunks</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> h </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">7</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#B8A965">        print</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">'x_</span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">h</span><span style="color:#C99076">}</span><span style="color:#C98A7D"> (binary): </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">pad_zeros</span><span style="color:#666666">(</span><span style="color:#B8A965">bin</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">model</span><span style="color:#666666">[</span><span style="color:#B8A965">input</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">h</span><span style="color:#666666">]].</span><span style="color:#DBD7CAEE">as_long</span><span style="color:#666666">())[</span><span style="color:#4C9A91">2</span><span style="color:#666666">:],</span><span style="color:#4C9A91">5</span><span style="color:#666666">)</span><span style="color:#C99076">}</span><span style="color:#C98A7D">'</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    firstNumber_val </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> model</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">evaluate</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">first_number</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    secondNumber_val </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> model</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">evaluate</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">second_number</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    # Convert Z3 BitVecNumRef to int and then to binary string</span></span>
<span class="line"><span style="color:#DBD7CAEE">    firstNumber_bin </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pad_zeros</span><span style="color:#666666">(</span><span style="color:#B8A965">bin</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">firstNumber_val</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">as_long</span><span style="color:#666666">())[</span><span style="color:#4C9A91">2</span><span style="color:#666666">:],</span><span style="color:#4C9A91"> 16</span><span style="color:#666666">)</span><span style="color:#758575DD">  # Remove the '0b' prefix</span></span>
<span class="line"><span style="color:#DBD7CAEE">    secondNumber_bin </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pad_zeros</span><span style="color:#666666">(</span><span style="color:#B8A965">bin</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">secondNumber_val</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">as_long</span><span style="color:#666666">())[</span><span style="color:#4C9A91">2</span><span style="color:#666666">:],</span><span style="color:#4C9A91"> 16</span><span style="color:#666666">)</span><span style="color:#758575DD">  # Remove the '0b' prefix</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">firstNumber (binary):</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> firstNumber_bin</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">secondNumber (binary):</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> secondNumber_bin</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    # Print product of firstNumber and secondNumber</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">product (binary):</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pad_zeros</span><span style="color:#666666">(</span><span style="color:#B8A965">bin</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">model</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">evaluate</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">product</span><span style="color:#666666">).</span><span style="color:#DBD7CAEE">as_long</span><span style="color:#666666">())[</span><span style="color:#4C9A91">2</span><span style="color:#666666">:],</span><span style="color:#4C9A91"> 16</span><span style="color:#666666">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965">print</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">'</span><span style="color:#C99076">\n</span><span style="color:#C98A7D"> ->>>  That</span><span style="color:#C99076">\'</span><span style="color:#C98A7D">s </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">count</span><span style="color:#C99076">}</span><span style="color:#C98A7D"> model</span><span style="color:#C99076">{</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">s</span><span style="color:#C98A7D77">"</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> count </span><span style="color:#CB7676">></span><span style="color:#4C9A91"> 1</span><span style="color:#4D9375"> else</span><span style="color:#C98A7D77"> ""</span><span style="color:#C99076">}</span><span style="color:#C98A7D">!'</span><span style="color:#666666">)</span></span>
<span class="line"></span></code></pre>
<p>For example, for page 35, the script outputs the following:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Found a solution</span></span>
<span class="line"><span>x_0 = 14</span></span>
<span class="line"><span>x_1 = 21</span></span>
<span class="line"><span>x_2 = 4</span></span>
<span class="line"><span>x_3 = 21</span></span>
<span class="line"><span>x_4 = 3</span></span>
<span class="line"><span>x_5 = 18</span></span>
<span class="line"><span>x_6 = 17</span></span>
<span class="line"><span>Sum of first two numbers: 35</span></span>
<span class="line"><span>x_0 (binary): 01110</span></span>
<span class="line"><span>x_1 (binary): 10101</span></span>
<span class="line"><span>x_2 (binary): 00100</span></span>
<span class="line"><span>x_3 (binary): 10101</span></span>
<span class="line"><span>x_4 (binary): 00011</span></span>
<span class="line"><span>x_5 (binary): 10010</span></span>
<span class="line"><span>x_6 (binary): 10001</span></span>
<span class="line"><span>firstNumber (binary): 0111010101001001</span></span>
<span class="line"><span>secondNumber (binary): 1010100011100101</span></span>
<span class="line"><span>product (binary): 1001101011000001101001001001101</span></span>
<span class="line"><span></span></span>
<span class="line"><span> ->>>  That's 1 model!</span></span>
<span class="line"><span></span></span></code></pre>
<p>This gives us the sequence of indices of symbols to enter in the selector for page 35.</p>
<p>We can easily create a script that recreates the manual by running the Z3 script multiple times.</p>
<p><img src="/writeup_files/retro-mania/manual.png" alt="Manual"></p>
<h3 id="flag-decryption">Flag Decryption</h3>
<p>Once a sequence is entered and verified. The flag is then computed by manipulating the input sequence with values from a lookup table:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#758575DD">/* ----------------------------------- */</span></span>
<span class="line"><span style="color:#758575DD">/* ------------ Constants ------------ */</span></span>
<span class="line"><span style="color:#758575DD">/* ----------------------------------- */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> char</span><span style="color:#BD976A"> encryptedFlagsToXor</span><span style="color:#666666">[</span><span style="color:#4C9A91">8</span><span style="color:#666666">][</span><span style="color:#4C9A91">48</span><span style="color:#666666">]</span><span style="color:#666666"> =</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ed</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">82</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d7</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">8e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fa</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">26</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">27</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">63</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">51</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">63</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">20</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">78</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ab</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">81</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">da</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">cd</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">41</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">34</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">33</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">93</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">36</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">30</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">43</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">11</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">00</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">14</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">52</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">dd</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e5</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">66</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">43</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">10</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">27</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">20</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">06</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">94</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">74</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d7</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">59</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ca</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">23</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">23</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">02</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ad</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">55</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">59</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ec</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">90</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0e</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ac</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">50</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">dd</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">34</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">8a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ac</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">33</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">96</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">24</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">84</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">06</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">94</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">74</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ad</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">74</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ca</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">30</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">18</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b7</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">34</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bf</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">26</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fe</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">87</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">be</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">89</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">54</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">59</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ec</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">90</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0e</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">60</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">11</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ef</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">95</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">10</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e5</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">29</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">60</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">db</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">64</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">20</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">34</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">eb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">93</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fd</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">12</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ca</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">23</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">48</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b7</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">40</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">29</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ec</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">93</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">87</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ce</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">81</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">74</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">43</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">aa</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ab</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">dc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">58</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">70</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">67</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">8b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">45</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">99</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">58</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">da</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ae</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ae</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">11</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">8c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">09</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">8c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">50</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">54</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ae</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b5</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">96</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">58</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">72</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">be</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">41</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">20</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f6</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ce</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d8</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d5</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">22</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">eb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">94</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">03</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ca</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">04</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">55</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">01</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">33</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">02</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">13</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">cd</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d5</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">26</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ef</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">46</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">03</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">59</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">16</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">76</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e4</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">13</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">66</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">66</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">be</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">83</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ba</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">78</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">46</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">cf</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">84</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c3</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">a9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">67</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">42</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">42</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">10</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">6b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">42</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">8a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ed</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f8</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">81</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ac</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ba</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">54</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">09</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">03</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">de</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">be</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">89</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">54</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4f</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">d1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">56</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">38</span><span style="color:#666666">},</span></span>
<span class="line"><span style="color:#666666">{</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">66</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bd</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">4d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f6</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">97</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c9</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e4</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">72</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">38</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3c</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">43</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">85</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">88</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">e1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">da</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">fc</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">ae</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">bb</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">0b</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">89</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">9e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">45</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">68</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">03</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">99</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">5a</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f2</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">38</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">aa</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">b1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">94</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">2e</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c8</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">67</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7d</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f0</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">33</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">79</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">97</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">c5</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">93</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">54</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">f1</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">af</span><span style="color:#666666">,</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">3f</span><span style="color:#666666">}};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">// Page -> Licence</span></span>
<span class="line"><span style="color:#758575DD">// 18 -> [10,8,7,19,7,21,21]</span></span>
<span class="line"><span style="color:#758575DD">// 19 -> [10,9,17,17,3,19,21]</span></span>
<span class="line"><span style="color:#758575DD">// 21 -> [12,9,0,17,8,18,19]</span></span>
<span class="line"><span style="color:#758575DD">// 23 -> [10,13,20,17,0,18,21]</span></span>
<span class="line"><span style="color:#758575DD">// 25 -> [14,11,17,17,13,19,17]</span></span>
<span class="line"><span style="color:#758575DD">// 33 -> [8,25,23,17,17,3,23]</span></span>
<span class="line"><span style="color:#758575DD">// 34 -> [12,22,24,25,2,18,19]</span></span>
<span class="line"><span style="color:#758575DD">// 35 -> [14,21,4,21,3,18,17]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">static</span><span style="color:#CB7676"> const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> int</span><span style="color:#BD976A"> lookupTable</span><span style="color:#666666">[</span><span style="color:#4C9A91">256</span><span style="color:#666666">]</span><span style="color:#666666"> =</span></span>
<span class="line"><span style="color:#666666">{</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">e3632863</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d3a3acf1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">46654e99</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">671788f4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e54ce950</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">58a7d7cf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">df79af83</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a4961f65</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ace58226</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">79722ded</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">d12d87c0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">850c1cab</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2ba77233</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7e039bd7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b74acb5a</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d9bb7802</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9489765d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">156aac53</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1580d471</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2f193574</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">b1bbb965</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2a1b2b8d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a42690bf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f1066afb</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e512d669</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ce00dae1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">65b36c8f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1452f95d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ac044bf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d02b51bb</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">41d16bd8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7d62fe26</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ad13dc44</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6ef3c195</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1c0610e8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f39da12a</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">fe2c9359</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">43d77f94</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">86709a8c</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e5f21e93</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">c1226c72</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a7d13e7b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f03fccbc</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9a261e2e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">35b29517</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">73a35637</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f992a43</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3b296d97</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">aac30b37</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">78d1d29c</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">ffb41133</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">91947d9b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">71ead5df</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f787724</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a1d5b0f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">acbf1abf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3fef0725</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6e21c916</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3e2d78ff</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a5f9f9a7</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">dcdcab45</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e60dc41c</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9e07bafe</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a1a4981d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6614cf4e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">286f7712</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c2e1c0f3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b71b78d3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">811f1cb9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d24f45d3</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">827e8b7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">774d05b1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">60351132</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a6e4c4f1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3e0f3f46</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">60b34ea6</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6bd029d1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">277f3211</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7f702dc3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3d57ab9e</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">fc10303</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d873c4b8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3394239c</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">bba60eca</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">89db6e81</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">800e1c6b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">66627450</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d681d50d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1fecb397</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f00a3b1f</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">444e7aee</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">5e444333</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">396ec833</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b8d0ea4e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">4bfe90f5</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e6a498c9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">503c02b7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">cf32bccf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7c71ecf1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f08628f1</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">96c3457f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">89a799fc</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8dd0a459</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">62a09e7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d6c6e39b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">84185d51</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">56591432</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">5e465c26</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">cacb2364</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">944a68f6</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">e2443ed0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">fd7edf42</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e0dd6d90</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a6add233</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c842c8f7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b5ced77c</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a45c96e1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">db9b8043</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">825511e0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">44d96163</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">456382b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ed78476</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">def1db43</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">22c065f5</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d228b179</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b3172807</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">5455db9a</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9be83bc4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">51452cc4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8bf87748</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">28958b0d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">59f46c98</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a0700a37</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8955ee74</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">83983e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">44f44b01</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8b7263e3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">521215ec</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a0dd448f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b9590929</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">ae603b0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d66a753</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8e5ead09</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">106da902</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d3639b10</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7a14ae1e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">5a6c5629</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">fc70bfc2</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ac5446bf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">467c7838</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">53432fb8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2ec07236</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9aa2ea72</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">59202ef2</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">fa6eeee8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">efe5b29</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d9a78a3e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a4b6ef66</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a8aa58e8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ecfead0c</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">fbfe829d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9042a2ac</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">42c314d4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">eb823a30</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">16844072</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ec0216e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">43f82ff</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">23348c0e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f9b93c1a</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c74e740d</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">cb1c9cbf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">619dfe9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d7632c4b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8fcb0c55</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c102058e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">15f65c</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">da2d2c68</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">fa4d68b4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e8155e5e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">97c82c5b</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">74f7d343</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">32a71c7f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8da6d309</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">a6b10e43</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ab7355d4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">359a9e53</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d4539ec8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">feb443c1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6bc2f39f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7eca8d56</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">e2240832</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">40f671</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">fb04f458</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">35ce7f0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">659c5e5d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">27c0c9e4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2a5fed3d</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ebb077b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c7253b28</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">45c30585</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">3235f59f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d646aa04</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3a1ec947</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">49ed68ea</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9d53ab4c</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">17516031</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6ed4b8d9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">53942226</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">5146d2ed</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c4d0577f</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">c5d8e6ae</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8128b4ae</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">79aa35a3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f13cacf0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e2d991f3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">169a66f0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f1765282</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d92d76f5</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">133ddad9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">5731d4f2</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">60f013fe</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">71e47c23</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b297881a</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f7ccb892</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ce5e7977</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">d943351b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b2f171c9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b34d1ecf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">37ce662f</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">29e67ada</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">2859a97b</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9acdfe23</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c5d38ddc</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">9bd0e2d7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">800046d2</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">8f5187f9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">bf0642a5</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b448cd44</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3a710e43</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">3673523</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">f3bd32b0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6d1a8cfe</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">e66f05d3</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7634f6f1</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">74d83a04</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">665a6da9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">6727bd27</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2a24c393</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">459cb6d4</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">79282327</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#CB7676">    0x</span><span style="color:#4C9A91">3e19646e</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">b90139e0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ffb23dc9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">81683ac6</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">c6b089a6</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1a2a355b</span></span>
<span class="line"><span style="color:#666666">};</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">/* --------------------------------- */</span></span>
<span class="line"><span style="color:#758575DD">/* ------------ Buffers ------------ */</span></span>
<span class="line"><span style="color:#758575DD">/* --------------------------------- */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#BD976A"> keyToXor</span><span style="color:#666666">[</span><span style="color:#4C9A91">7</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#CB7676">char</span><span style="color:#BD976A"> finalFlag</span><span style="color:#666666">[</span><span style="color:#4C9A91">52</span><span style="color:#666666">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">void</span><span style="color:#80A665"> generateKey</span><span style="color:#666666">(</span><span style="color:#CB7676">const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> char*</span><span style="color:#BD976A"> licence</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">{</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#666666">(</span><span style="color:#CB7676">int</span><span style="color:#DBD7CAEE"> i </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 7</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i</span><span style="color:#CB7676">++</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">    {</span></span>
<span class="line"><span style="color:#BD976A">        keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> lookupTable</span><span style="color:#666666">[</span><span style="color:#BD976A">licence</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#CB7676"> 0b</span><span style="color:#4C9A91">10101010</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#BD976A">        keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^=</span><span style="color:#BD976A"> lookupTable</span><span style="color:#666666">[(</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> char</span><span style="color:#666666">)((</span><span style="color:#BD976A">keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]</span><span style="color:#CB7676"> >></span><span style="color:#DBD7CAEE"> i</span><span style="color:#666666">)</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">)];</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#666666">(</span><span style="color:#CB7676">int</span><span style="color:#DBD7CAEE"> i </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 7</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i</span><span style="color:#CB7676">++</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">    {</span></span>
<span class="line"><span style="color:#CB7676">        int</span><span style="color:#DBD7CAEE"> effectivePrev </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">==</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676"> ?</span><span style="color:#4C9A91"> 6</span><span style="color:#CB7676"> :</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">-</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">        int</span><span style="color:#DBD7CAEE"> effectiveNext </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">==</span><span style="color:#4C9A91"> 6</span><span style="color:#CB7676"> ?</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676"> :</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A">        keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^=</span><span style="color:#666666"> (</span><span style="color:#BD976A">keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">effectivePrev</span><span style="color:#666666">]</span><span style="color:#CB7676"> ^</span><span style="color:#BD976A"> keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">effectiveNext</span><span style="color:#666666">]);</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">void</span><span style="color:#80A665"> getFlag</span><span style="color:#666666">(</span><span style="color:#CB7676">const</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> int</span><span style="color:#BD976A"> pageIndex</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">{</span></span>
<span class="line"><span style="color:#CB7676">    unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> buffer</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    char*</span><span style="color:#DBD7CAEE"> encryptedFlag </span><span style="color:#666666">=</span><span style="color:#BD976A"> encryptedFlagsToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">pageIndex</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#666666">(</span><span style="color:#CB7676">int</span><span style="color:#DBD7CAEE"> h </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> h </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 48</span><span style="color:#CB7676"> /</span><span style="color:#4C9A91"> 4</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> h</span><span style="color:#CB7676">++</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#666666">    {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        buffer </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">((</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">encryptedFlag </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> h</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        buffer </span><span style="color:#CB7676">^=</span><span style="color:#BD976A"> keyToXor</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">h </span><span style="color:#CB7676">%</span><span style="color:#4C9A91"> 7</span><span style="color:#666666">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">        *</span><span style="color:#666666">((</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">finalFlag </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> h</span><span style="color:#666666">)</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> buffer</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    // Last byte</span></span>
<span class="line"><span style="color:#DBD7CAEE">    buffer </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#666666">)</span><span style="color:#BD976A">encryptedFlag</span><span style="color:#666666">[</span><span style="color:#4C9A91">48</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    buffer </span><span style="color:#CB7676">^=</span><span style="color:#BD976A"> keyToXor</span><span style="color:#666666">[</span><span style="color:#4C9A91">6</span><span style="color:#666666">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">    *</span><span style="color:#666666">((</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">finalFlag </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 12</span><span style="color:#666666">)</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> buffer</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>There are 8 encrypted versions of the flag, one for each page. Even if you force the call to <code>getFlag</code> with a sequence and page number that do not match, you will not get the flag, since the sequence is used to generate a key that is then used to decrypt the flag.</p>
<p>Still, reversing this part of the game is not required, since you can run the game again with the correct sequence and reach the screen where John the Genie awards you the flag.</p>
<p><img src="/writeup_files/retro-mania/solved_selector.png" alt="Solved Selector"></p>
<p>We receive a success message containing our flag:</p>
<p><img src="/writeup_files/retro-mania/solved_message.png" alt="Solved Message"></p>
<p>And finally, the flag is revealed:</p>
<p><img src="/writeup_files/retro-mania/flag.png" alt="Flag"></p>
<p>If you got the reference in the flag, you are indeed a good person. If not, I highly recommend to grab a copy of <a href="https://sims.fandom.com/wiki/The_Urbz:_Sims_in_the_City_(handheld)">The Urbz: Sims in the City</a> for the GBA and play it. It is a great game, and you will not regret it (especially if you are a fan of adventure games).</p>
<p>Useful reference to reverse engineer GBA ROMs:</p>
<ul>
<li><a href="https://problemkaputt.de/gbatek-index.htm">https://problemkaputt.de/gbatek-index.htm</a></li>
</ul>  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 Tower of Hanoi. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://twitter.com/towerofhanoi" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Tower of Hanoi on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/towerofhanoi" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Tower of Haoi's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://ctftime.org/team/300" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Tower of Hanoi's CTF Time page</span> <svg viewBox="0 0 16 16" width="32" height="32" data-astro-cid-sz7xmlte> <path fill="currentColor" d="M 0,0 H 16 V 16 H 0 L 4.7205698,7.7838485 Z" data-astro-cid-sz7xmlte></path> </svg> </a> </div> </footer>  </body></html>