<!DOCTYPE html><html lang="en" data-astro-cid-dxom2xcl> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.18"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://localhost:3000/writeups/2025-03-14-sudo-kurl/"><!-- Primary Meta Tags --><title>TRX CTF 2025 - sudo-kurl</title><meta name="title" content="TRX CTF 2025 - sudo-kurl"><meta name="description" content="Writeup of sudo-kurl challenge from TRX CTF 2025"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://localhost:3000/writeups/2025-03-14-sudo-kurl/"><meta property="og:title" content="TRX CTF 2025 - sudo-kurl"><meta property="og:description" content="Writeup of sudo-kurl challenge from TRX CTF 2025"><meta property="og:image" content="https://localhost:3000/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://localhost:3000/writeups/2025-03-14-sudo-kurl/"><meta property="twitter:title" content="TRX CTF 2025 - sudo-kurl"><meta property="twitter:description" content="Writeup of sudo-kurl challenge from TRX CTF 2025"><meta property="twitter:image" content="https://localhost:3000/blog-placeholder-1.jpg"><style>:root{--accent: #fea819;--accent-dark: #ac7010;--accent-dark-010: #ac70100a}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-regular.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-bold.woff) format("woff");font-weight:700;font-style:normal;font-display:swap}body{font-family:Atkinson,sans-serif;margin:0;padding:0;text-align:left;background:#171717 no-repeat;background-size:100% 600px;word-wrap:break-word;overflow-wrap:break-word;color:#aaa;font-size:20px;line-height:1.25}main{width:720px;max-width:calc(100% - 2em);margin:auto;padding:3em 1em}h1,h2,h3,h4,h5,h6{margin:1em 0 .5rem;color:#fff;line-height:1.2}h1{font-size:3.052em}h2{font-size:2.441em}h3{font-size:1.953em}h4{font-size:1.563em}h5{font-size:1.25em}strong,b{font-weight:700}a,a:hover{color:var(--accent)}p{margin-bottom:1em}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%}img{max-width:100%;height:auto;border-radius:8px}code{padding:0 .3em;background-color:#1f1f1f;border-radius:.2em;font-size:.8em}pre{padding:1em;border-radius:.2em}pre>code{all:unset;font-size:.8em}blockquote{border-left:4px solid var(--accent);padding:.01em 0 .01em 1em;margin:0;background-color:var(--accent-dark-010)}hr{border:none;border-top:1px solid #e9e9e9}@media (max-width: 720px){body{font-size:18px}main{padding:1em}}.sr-only{border:0;padding:0;margin:0;position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap}table{border-collapse:collapse;text-align:center}tr{border:1px solid #e9e9e9}th,td{padding:.5em;text-align:center}th{background-color:#1f1f1f;color:#fff}td{background-color:#1b1b1b}a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#1f1f1f;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
@media (prefers-color-scheme: dark){.markdown-alert{--color-border-default: #30363d;--color-accent-fg: #58a6ff;--color-accent-emphasis: #1f6feb;--color-danger-fg: #f85149;--color-danger-emphasis: #da3633;--color-attention-fg: #d29922;--color-attention-emphasis: #9e6a03;--color-done-fg: #a371f7;--color-done-emphasis: #8957e5;--color-success-fg: #3fb950;--color-success-emphasis: #238636}}@media (prefers-color-scheme: light){.markdown-alert{--color-border-default: #d0d7de;--color-accent-fg: #0969da;--color-accent-emphasis: #0969da;--color-danger-fg: #d1242f;--color-danger-emphasis: #cf222e;--color-attention-fg: #9a6700;--color-attention-emphasis: #9a6700;--color-done-fg: #8250df;--color-done-emphasis: #8250df;--color-success-fg: #1a7f37;--color-success-emphasis: #1f883d}}.markdown-alert{border-left:.25em solid var(--borderColor-default, var(--color-border-default));color:inherit;margin-bottom:16px;padding:.5rem 1em}.markdown-alert>:last-child{margin-bottom:0!important}.markdown-alert .markdown-alert-title{align-items:center;display:flex;font-size:14px;font-weight:500;line-height:1}.markdown-alert .markdown-alert-title svg.octicon{margin-right:8px!important;margin-right:var(--base-size-8,8px)!important;fill:currentColor}.markdown-alert.markdown-alert-note{border-left-color:var(--borderColor-accent-emphasis,var(--color-accent-emphasis))}.markdown-alert.markdown-alert-note .markdown-alert-title{color:var(--color-accent-fg);color:var(--fgColor-accent,var(--color-accent-fg))}.markdown-alert.markdown-alert-tip{border-left-color:var(--borderColor-success-emphasis,var(--color-success-emphasis))}.markdown-alert.markdown-alert-tip .markdown-alert-title{color:var(--color-success-fg);color:var(--fgColor-success,var(--color-success-fg))}.markdown-alert.markdown-alert-important{border-left-color:var(--borderColor-done-emphasis,var(--color-done-emphasis))}.markdown-alert.markdown-alert-important .markdown-alert-title{color:var(--color-done-fg);color:var(--fgColor-done,var(--color-done-fg))}.markdown-alert.markdown-alert-warning{border-left-color:var(--borderColor-attention-emphasis,var(--color-attention-emphasis))}.markdown-alert.markdown-alert-warning .markdown-alert-title{color:var(--color-attention-fg);color:var(--fgColor-attention,var(--color-attention-fg))}.markdown-alert.markdown-alert-caution{border-left-color:var(--borderColor-danger-emphasis,var(--color-danger-emphasis))}.markdown-alert.markdown-alert-caution .markdown-alert-title{color:var(--color-danger-fg);color:var(--fgColor-danger,var(--color-danger-fg))}main[data-astro-cid-dxom2xcl]{width:calc(100% - 2em);max-width:100%;margin:0}.hero-image[data-astro-cid-dxom2xcl]{width:100%}.hero-image[data-astro-cid-dxom2xcl] img[data-astro-cid-dxom2xcl]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-dxom2xcl]{width:75%;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-dxom2xcl]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-dxom2xcl] h1[data-astro-cid-dxom2xcl]{margin:0 0 .5em}.date[data-astro-cid-dxom2xcl]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-dxom2xcl]{font-style:italic}
</style></head> <body data-astro-cid-dxom2xcl> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <a href="/" style="padding: 1rem 0 0 0;" data-astro-cid-3ef6ksr2> <img src="/new_tower_logo.png" alt="Tower of Hanoi Logo" width="50rem" height="50rem" style="border-radius: 0;" data-astro-cid-3ef6ksr2> </a> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/blog" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blogposts </a>  <a href="/writeups" class="active" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Writeups </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://x.com/towerofhanoi" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Follow Tower of Hanoi on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://github.com/towerofhanoi" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Tower of Hanoi's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://ctftime.org/team/300" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Tower of Hanoi's CTF Time page</span> <svg viewBox="0 0 16 16" width="32" height="32" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M 0,0 H 16 V 16 H 0 L 4.7205698,7.7838485 Z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </nav> </header>  <main data-astro-cid-dxom2xcl> <article data-astro-cid-dxom2xcl> <div class="hero-image" data-astro-cid-dxom2xcl> <img width="720" height="360" src="/writeup_images/trx-ctf-25.png" alt="" data-astro-cid-dxom2xcl> </div> <div class="prose" data-astro-cid-dxom2xcl> <div class="title" data-astro-cid-dxom2xcl> <div class="date" data-astro-cid-dxom2xcl> <time datetime="2025-03-14T13:00:00.000Z"> Mar 14, 2025 </time>  </div> <h1 data-astro-cid-dxom2xcl>TRX CTF 2025 - sudo-kurl</h1> <h3 data-astro-cid-dxom2xcl> by Luca Padalino (padawan)</h3> <hr data-astro-cid-dxom2xcl> </div>  <p>Challenge README:</p>
<blockquote>
<p>The year is 3000 AD. The Pax Romana extends to the stars, but peace has been shattered. Xenomorph invaders challenge the might of the New Roman Empire. A letter arrives from the Senate, sealed with the golden eagle of Rome. It reads:</p>
</blockquote>
<blockquote>
<p>“Darius Caesar, the stars burn with conflict. The alien invaders are unlike anything we’ve faced before—ruthless, cunning, and relentless. They strike at our borders, threatening to unravel the Pax Galactica and reduce the New Roman Empire to ashes. Our legions are strong, but strength alone will not win this war. You must outthink, outmaneuver, and outlast them. The fate of humanity hangs by a thread, and only your brilliance can secure our future. Will you rise to the challenge and lead us to victory, or shall Rome fall to the void?”</p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>There was only a binary file (<code>chall</code>) attached to this challenge. The output of the <code>file</code> command was:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#80A665">chall:</span><span style="color:#C98A7D"> ELF</span><span style="color:#C98A7D"> 64-bit</span><span style="color:#C98A7D"> LSB</span><span style="color:#C98A7D"> pie</span><span style="color:#C98A7D"> executable,</span><span style="color:#C98A7D"> x86-64,</span><span style="color:#C98A7D"> version</span><span style="color:#4C9A91"> 1</span><span style="color:#DBD7CAEE"> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, </span><span style="color:#BD976A">BuildID</span><span style="color:#666666">[</span><span style="color:#BD976A">sha1</span><span style="color:#666666">]=</span><span style="color:#C98A7D">ae4c7f64246b2a03dd90a3ee5c2a76ea4826aa0b,</span><span style="color:#80A665"> for</span><span style="color:#C98A7D"> GNU/Linux</span><span style="color:#C98A7D"> 3.2.0,</span><span style="color:#C98A7D"> not</span><span style="color:#C98A7D"> stripped</span></span>
<span class="line"></span></code></pre>
<p>We also executed <code>pwn checksec chall</code> to discover enabled mitigations:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#80A665">Arch:</span><span style="color:#C98A7D">       amd64-64-little</span></span>
<span class="line"><span style="color:#80A665">RELRO:</span><span style="color:#C98A7D">      Full</span><span style="color:#C98A7D"> RELRO</span></span>
<span class="line"><span style="color:#80A665">Stack:</span><span style="color:#C98A7D">      Canary</span><span style="color:#C98A7D"> found</span></span>
<span class="line"><span style="color:#80A665">NX:</span><span style="color:#C98A7D">         NX</span><span style="color:#C98A7D"> enabled</span></span>
<span class="line"><span style="color:#80A665">PIE:</span><span style="color:#C98A7D">        PIE</span><span style="color:#C98A7D"> enabled</span></span>
<span class="line"><span style="color:#80A665">SHSTK:</span><span style="color:#C98A7D">      Enabled</span></span>
<span class="line"><span style="color:#80A665">IBT:</span><span style="color:#C98A7D">        Enabled</span></span>
<span class="line"><span style="color:#80A665">Stripped:</span><span style="color:#C98A7D">   No</span></span>
<span class="line"></span></code></pre>
<p>After enabling execution permissions (<code>chmod +x chall</code>), the following splash text appears:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Welcome, Darius Caesar. </span></span>
<span class="line"><span>The Senate has entrusted you with the fate of the New Roman Empire. </span></span>
<span class="line"><span>Our legions await your orders, and the alien menace encroaches upon our borders.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Caesar, the legions await your command. Specify the sector where our forces should deploy.</span></span>
<span class="line"><span>Row [1-25] (-1 to check win): </span></span>
<span class="line"><span></span></span></code></pre>
<p>The user is prompted to insert a row index, then a column index, then a value to be stored in that cell. By repeatedly entering <code>1</code>, the program exits, showing the following message:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Welcome, Darius Caesar. </span></span>
<span class="line"><span>The Senate has entrusted you with the fate of the New Roman Empire. </span></span>
<span class="line"><span>Our legions await your orders, and the alien menace encroaches upon our borders.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Caesar, the legions await your command. Specify the sector where our forces should deploy.</span></span>
<span class="line"><span>Row [1-25] (-1 to check win): 1</span></span>
<span class="line"><span>Column [1-25]: 1</span></span>
<span class="line"><span>Troups [1-25]: 1</span></span>
<span class="line"><span>A miscalculation, Darius. The aliens exploit our weaknesses.</span></span>
<span class="line"><span></span></span></code></pre>
<p>It is also possible to check for victory by typing <code>-1</code> in the console when the row index is asked. The output is the following:</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Welcome, Darius Caesar. </span></span>
<span class="line"><span>The Senate has entrusted you with the fate of the New Roman Empire. </span></span>
<span class="line"><span>Our legions await your orders, and the alien menace encroaches upon our borders.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Caesar, the legions await your command. Specify the sector where our forces should deploy.</span></span>
<span class="line"><span>Row [1-25] (-1 to check win): -1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>The legions have fallen, and the Senate lies in ruins. The alien horde swarms across the galaxy, extinguishing the light of the New Roman Empire. Your name, once shouted in triumph, is now whispered in despair. The dream of eternal Rome ends here, Dominus. But remember—history is not kind to the vanquished. The stars, once ours, now belong to the void. Hail, fallen Caesar.</span></span>
<span class="line"><span></span></span></code></pre>
<p>At first glance, it was unclear when and how the flag could be read. Likewise, the logic behind the row indices, column indices, and the specific cell value triggering either program termination or flag access was also unclear—it’s time to dive into the code!</p>
<h2 id="approach">Approach</h2>
<p>To decompile and disassemble the code, we used Ghidra. From the very beginning, we noticed that the challenge was written in C++ and has the following functions. For each of those, we provide the decompiled code and a high-level description.</p>
<h3 id="functions">Functions</h3>
<h4 id="main"><code>main()</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#CB7676">int</span><span style="color:#80A665"> main</span><span style="color:#666666">(</span><span style="color:#CB7676">void</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ostream </span><span style="color:#CB7676">*</span><span style="color:#C99076">this</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">  </span></span>
<span class="line"><span style="color:#C99076">    this</span><span style="color:#666666"> =</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">        "</span><span style="color:#C98A7D">Welcome, Darius Caesar. </span><span style="color:#C99076">\n</span><span style="color:#C98A7D">The Senate has entrusted you with the fate of th e New Roman Empire. </span><span style="color:#C99076">\n</span><span style="color:#C98A7D">Our legions await your orders, and the alien menace e ncroaches upon our borders.</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#666666">    );</span></span>
<span class="line"><span style="color:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#C99076">this</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    play</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>This is the first function called after the initialization phase. After printing a welcome message, it calls the <code>play()</code> function.</p>
<h4 id="play"><code>play()</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#CB7676">void</span><span style="color:#80A665"> play</span><span style="color:#666666">(</span><span style="color:#CB7676">void</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#CB7676">    bool</span><span style="color:#DBD7CAEE"> checkBoardValidity</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    char</span><span style="color:#DBD7CAEE"> checkWinResult</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ostream </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    string finalFlag </span><span style="color:#666666">[</span><span style="color:#4C9A91">32</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector computedFlag </span><span style="color:#666666">[</span><span style="color:#4C9A91">32</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    string tempFlag </span><span style="color:#666666">[</span><span style="color:#4C9A91">40</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canary</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canary </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">    do</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        checkBoardValidity </span><span style="color:#666666">=</span><span style="color:#80A665"> isValid</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">checkBoardValidity</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">A miscalculation, Darius. The aliens exploit our weaknesses.</span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            goto</span><span style="color:#80A665"> LAB_CANARY_CHECK</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#DBD7CAEE">        checkBoardValidity </span><span style="color:#666666">=</span><span style="color:#80A665"> askInput</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">    }</span><span style="color:#4D9375"> while</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">checkBoardValidity</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:#DBD7CAEE">    checkWinResult </span><span style="color:#666666">=</span><span style="color:#80A665"> checkWin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">checkWinResult </span><span style="color:#CB7676">==</span><span style="color:#C98A7D77"> '</span><span style="color:#C99076">\0</span><span style="color:#C98A7D77">'</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">FALLEN_LEGIONS_MESSAGE</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">    }</span><span style="color:#4D9375"> else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C99076">\n</span><span style="color:#C98A7D">Victory is ours, Darius! </span><span style="color:#C99076">\n</span><span style="color:#C98A7D">The alien forces have been routed, and their stronghold burns under the New Roman banner. </span><span style="color:#C99076">\n</span><span style="color:#C98A7D">The Sena te declares you </span><span style="color:#C99076">\'</span><span style="color:#C98A7D">Imperator Invictus</span><span style="color:#C99076">\'</span><span style="color:#C98A7D">!</span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#BD976A">        getFlag</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">abi:cxx11</span><span style="color:#666666">](</span><span style="color:#DBD7CAEE">computedFlag</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">+</span><span style="color:#666666">((</span><span style="color:#CB7676">char</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">tempFlag</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">string </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">FLAG_HEADER</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">+</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">finalFlag</span><span style="color:#666666">,(</span><span style="color:#CB7676">char</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">tempFlag</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">string</span><span style="color:#666666">::</span><span style="color:#CB7676">~</span><span style="color:#80A665">string</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">tempFlag</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">string</span><span style="color:#666666">::</span><span style="color:#CB7676">~</span><span style="color:#80A665">string</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">string </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">computedFlag</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">finalFlag</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">string</span><span style="color:#666666">::</span><span style="color:#CB7676">~</span><span style="color:#80A665">string</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">finalFlag</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665">LAB_CANARY_CHECK</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canary </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>This is the main function of the challenge. At the beginning, there is a loop where the board is validated using <code>isValid(board)</code>. If the board is valid, the program requests input from the user via <code>askInput(board)</code>. This loop continues until the user explicitly requests a verification by entering <code>-1</code>. Once the loop exits, the program checks for a win condition using <code>checkWin(board)</code>. If the player loses, a defeat message is displayed. Otherwise, the program retrieves and prints the secret flag using <code>getFlag(computedFlag)</code>. Additionally, the code includes stack canary protection (<code>__stack_chk_fail()</code>) to guard against buffer overflow exploits.</p>
<h4 id="isvalidboard"><code>isValid(*board)</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#CB7676">bool</span><span style="color:#80A665"> isValid</span><span style="color:#666666">(</span><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">boardPtr</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> iVar1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">beginRowPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">colVecIndex</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector local_DL_606</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">var1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined1 finalOutcome</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined1 cellVec </span><span style="color:#666666">[</span><span style="color:#4C9A91">16</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> rowIndex</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> colIndex</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> i</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> j</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> local_a8</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> local_a4</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> cellVec_2</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 cellVec_1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> mask_1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> cell_3</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined1 rowPtr </span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">]</span><span style="color:#666666"> [</span><span style="color:#4C9A91">16</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    allocator</span><span style="color:#CB7676">&#x3C;bool></span><span style="color:#DBD7CAEE"> long_2 </span><span style="color:#666666">[</span><span style="color:#4C9A91">40</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canary</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    bool</span><span style="color:#DBD7CAEE"> check</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canary </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">rowIndex </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> rowIndex </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 25</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> rowIndex </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> rowIndex </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">bool</span><span style="color:#666666">>::</span><span style="color:#80A665">allocator</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#DBD7CAEE">        mask_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> mask_1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ffffffffffffff00</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ulong</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">bool</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#4C9A91">26</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">allocator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">mask_1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">bool</span><span style="color:#666666">>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">allocator</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">bool</span><span style="color:#666666">>::</span><span style="color:#80A665">allocator</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#DBD7CAEE">        cellVec_2 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> cellVec_2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ffffffffffffff00</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ulong</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">,(</span><span style="color:#CB7676">bool</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#4C9A91">26</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">allocator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">cellVec_2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">bool</span><span style="color:#666666">>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">allocator</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">allocator</span><span style="color:#CB7676">&#x3C;bool></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">mask_1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        for</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">colIndex </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> colIndex </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 25</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> colIndex </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> colIndex </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            beginRowPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colVecIndex </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">            LAB_CHECK_FALSE</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#4D9375">            else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                beginRowPtr_1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                cellVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colVecIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                _cell_3 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_8_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                mask_1 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_0_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">_Bit_reference</span><span style="color:#666666">::</span><span style="color:#BD976A">operator</span><span style="color:#666666">.</span><span style="color:#BD976A">cast</span><span style="color:#666666">.</span><span style="color:#BD976A">to</span><span style="color:#666666">.</span><span style="color:#80A665">bool</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">_Bit_reference </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">mask_1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">                if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#4D9375"> goto</span><span style="color:#80A665"> LAB_CHECK_FALSE</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                finalOutcome </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">                goto</span><span style="color:#80A665"> LAB_001028c0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#DBD7CAEE">            beginRowPtr_1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colVecIndex </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">            LAB_CHECK_KO</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#4D9375">            else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                beginRowPtr_1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                cellVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colVecIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                _cell_3 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_8_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                mask_1 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_0_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">_Bit_reference</span><span style="color:#666666">::</span><span style="color:#BD976A">operator</span><span style="color:#666666">.</span><span style="color:#BD976A">cast</span><span style="color:#666666">.</span><span style="color:#BD976A">to</span><span style="color:#666666">.</span><span style="color:#80A665">bool</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">_Bit_reference </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">mask_1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">                if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#4D9375"> goto</span><span style="color:#80A665"> LAB_CHECK_KO</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                finalOutcome </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                check </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">                goto</span><span style="color:#80A665"> LAB_001028c0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#DBD7CAEE">            beginRowPtr_1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            cellVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colVecIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            cellVec_1 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_8_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            cellVec_2 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_0_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">_Bit_reference</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#666666">=((</span><span style="color:#DBD7CAEE">_Bit_reference </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">cellVec_2</span><span style="color:#666666">,</span><span style="color:#4D9375">true</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            beginRowPtr_1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            cellVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colVecIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            _cell_3 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_8_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            mask_1 </span><span style="color:#666666">=</span><span style="color:#BD976A"> cellVec</span><span style="color:#666666">.</span><span style="color:#BD976A">_0_8_</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">_Bit_reference</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#666666">=((</span><span style="color:#DBD7CAEE">_Bit_reference </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">mask_1</span><span style="color:#666666">,</span><span style="color:#4D9375">true</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#DBD7CAEE">        check </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">        LAB_001028c0</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#4D9375"> goto</span><span style="color:#80A665"> LAB_EXIT_FUNCTION</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">i </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 25</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> i </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#4D9375">        for</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">j </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> j </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 25</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> j </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> j </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">bool</span><span style="color:#666666">>::</span><span style="color:#80A665">allocator</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#DBD7CAEE">            mask_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> mask_1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ffffffffffffff00</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ulong</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">,(</span><span style="color:#CB7676">bool</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">1a</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">allocator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">mask_1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">bool</span><span style="color:#666666">>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">allocator</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">allocator</span><span style="color:#CB7676">&#x3C;bool></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            for</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">local_a8 </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> local_a8 </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> local_a8 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> local_a8 </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#4D9375">                for</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">local_a4 </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> local_a4 </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">;</span><span style="color:#DBD7CAEE"> local_a4 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> local_a4 </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                    beginRowPtr_1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">local_a8 </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> i</span><span style="color:#666666">));</span></span>
<span class="line"><span style="color:#DBD7CAEE">                    colVecIndex </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginRowPtr_1</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">local_a4 </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> j</span><span style="color:#666666">));</span></span>
<span class="line"><span style="color:#DBD7CAEE">                    iVar1 </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">colVecIndex</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">                    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">iVar1 </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">                LAB_00102a0a</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">                        check </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">                    }</span><span style="color:#4D9375"> else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                        cellVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">iVar1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#BD976A">                        rowPtr</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> cellVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                        check </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">_Bit_reference</span><span style="color:#666666">::</span><span style="color:#BD976A">operator</span><span style="color:#666666">.</span><span style="color:#BD976A">cast</span><span style="color:#666666">.</span><span style="color:#BD976A">to</span><span style="color:#666666">.</span><span style="color:#80A665">bool</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">_Bit_reference </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">                        if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#4D9375"> goto</span><span style="color:#80A665"> LAB_00102a0a</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                        check </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">                    }</span></span>
<span class="line"><span style="color:#4D9375">                    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                        finalOutcome </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                        check </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">                        goto</span><span style="color:#80A665"> LAB_CHECK_OK</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">                    }</span></span>
<span class="line"><span style="color:#DBD7CAEE">                    cellVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">iVar1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#BD976A">                    rowPtr</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> cellVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">                    std</span><span style="color:#666666">::</span><span style="color:#80A665">_Bit_reference</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#666666">=((</span><span style="color:#DBD7CAEE">_Bit_reference </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">,</span><span style="color:#4D9375">true</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">                }</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#DBD7CAEE">            check </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">        LAB_CHECK_OK</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">long_2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">)</span><span style="color:#4D9375"> goto</span><span style="color:#80A665"> LAB_EXIT_FUNCTION</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#DBD7CAEE">    finalOutcome </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">    LAB_EXIT_FUNCTION</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canary </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#666666"> (</span><span style="color:#CB7676">bool</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">finalOutcome</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>The syntax of this disassembled function is particularly ugly. Of course, we asked to ChatGPT their thoughts on the code, and this was their response:</p>
<div align="center">
    <img src="/writeup_files/sudo-kurl/chatgpt.png" alt="ChatGPT">
</div>
<blockquote>
<p>💡 Essentially, this function should check for the board’s validity, operating on rows, columns, and sub-grids (likely 5x5, given the use of <code>0x19</code> and 5 in the loops). The verification approach is that of <em>Sudoku</em>, as the pun in the challenge title suggests. For each of row, column, and subgrid, it verifies that each number is not duplicated; otherwise, it returns an error code that leads to the program closing.</p>
</blockquote>
<h4 id="askinputboard"><code>askInput(*board)</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#CB7676">bool</span><span style="color:#80A665"> askInput</span><span style="color:#666666">(</span><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">boardPtr</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676">    bool</span><span style="color:#DBD7CAEE"> outcome</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ostream </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">colPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> rowIndex</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> colIndex</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> troupsNo</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canary</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canary </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">        "</span><span style="color:#C98A7D">Caesar, the legions await your command. Specify the sector where o ur forces should deploy.</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#666666">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Row [1-25] (-1 to check win): </span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">istream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">>></span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">istream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cin</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">rowIndex</span><span style="color:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">rowIndex </span><span style="color:#CB7676">==</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91">1</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        outcome </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">    }</span><span style="color:#4D9375"> else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Column [1-25]: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">istream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">>></span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">istream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cin</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">colIndex</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Troups [1-25]: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">istream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">>></span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">istream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cin</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">troupsNo</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> ((((</span><span style="color:#DBD7CAEE">rowIndex </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#CB7676"> ||</span><span style="color:#666666"> (</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#CB7676"> &#x3C;</span><span style="color:#DBD7CAEE"> rowIndex</span><span style="color:#666666">))</span><span style="color:#CB7676"> ||</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">colIndex </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">))</span><span style="color:#CB7676"> ||</span><span style="color:#666666"> (</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">19</span><span style="color:#CB7676"> &#x3C;</span><span style="color:#DBD7CAEE"> colIndex</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                "</span><span style="color:#C98A7D">You attempted to reinforce Saturn, but its fragile alliance wi th Mars has shattered. Their combined fury annihilated our forc es. This misstep will be recorded as a dark chapter in Roman hi story.</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#666666">            );</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            outcome </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#4D9375">        else</span><span style="color:#4D9375"> if</span><span style="color:#666666"> ((</span><span style="color:#DBD7CAEE">troupsNo </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">)</span><span style="color:#CB7676"> ||</span><span style="color:#666666"> (</span><span style="color:#4C9A91">25</span><span style="color:#CB7676"> &#x3C;</span><span style="color:#DBD7CAEE"> troupsNo</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span></span>
<span class="line"><span style="color:#C98A7D77">                "</span><span style="color:#C98A7D">Your decision to deploy all our troops into what appeared to b e a strategic stronghold was a trap. The aliens detonated a bom b, and our legions were obliterated. The stars grow dimmer with  our loss.</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#666666">            );</span></span>
<span class="line"><span style="color:#80A665">            std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            outcome </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#4D9375">        else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            rowPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">rowIndex </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91">1</span><span style="color:#666666">));</span></span>
<span class="line"><span style="color:#DBD7CAEE">            colPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">colIndex </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91">1</span><span style="color:#666666">));</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">colPtr </span><span style="color:#CB7676">==</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                rowPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">rowIndex </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91">1</span><span style="color:#666666">));</span></span>
<span class="line"><span style="color:#DBD7CAEE">                colPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">rowPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">long</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">colIndex </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91">1</span><span style="color:#666666">));</span></span>
<span class="line"><span style="color:#CB7676">                *</span><span style="color:#DBD7CAEE">colPtr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> troupsNo</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">                outcome </span><span style="color:#666666">=</span><span style="color:#4D9375"> true</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span><span style="color:#4D9375"> else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                stdoutStream </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#C98A7D77">                    "</span><span style="color:#C98A7D">The battlefield is overrun with alien forces, Dominus. There </span><span style="color:#C99076">\'</span><span style="color:#C98A7D">s no room for additional troops, and your efforts have led to chaos within the ranks.</span><span style="color:#C98A7D77">"</span></span>
<span class="line"><span style="color:#666666">                );</span></span>
<span class="line"><span style="color:#80A665">                std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">stdoutStream</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">                outcome </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canary </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> outcome</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>This function prompts the user to specify the row index, column index, and the number of troops to deploy. It validates whether the entered indices fall within the range of 1-25. For the row index, the value <code>-1</code> is also accepted, in which case the function returns control to the <code>play()</code> function to continue its execution.</p>
<blockquote>
<p>🔦 This function provides insight into the structure of the board, which appears to be a 25x25 grid.</p>
</blockquote>
<h4 id="checkwinboard"><code>checkWin(*board)</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"></span>
<span class="line"><span style="color:#CB7676">bool</span><span style="color:#80A665"> checkWin</span><span style="color:#666666">(</span><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">boardPtr</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#CB7676">    bool</span><span style="color:#DBD7CAEE"> isBoardValid</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#C99076">this</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">cellValue</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    __normal_iterator boardVecBegin</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    __normal_iterator boardVecEnd</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    __normal_iterator rowVecBegin</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    __normal_iterator rowVecEnd</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canaryStr</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canaryStr </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    _boardVecBegin </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    _boardVecEnd </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">    do</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        isBoardValid </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> operator</span><span style="color:#CB7676">!=</span><span style="color:#666666">(</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">boardVecBegin</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">boardVecEnd</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">isBoardValid</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            isBoardValid </span><span style="color:#666666">=</span><span style="color:#80A665"> isValid</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        LAB_CANARY_CHECK</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canaryStr </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">                __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#4D9375">            return</span><span style="color:#DBD7CAEE"> isBoardValid</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#C99076">        this</span><span style="color:#666666"> =</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">__normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">*</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">boardVecBegin</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        _rowVecBegin </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">(</span><span style="color:#C99076">this</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        _rowVecEnd </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">(</span><span style="color:#C99076">this</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        while</span><span style="color:#666666">(</span><span style="color:#4D9375">true</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            isBoardValid </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> operator</span><span style="color:#CB7676">!=</span><span style="color:#666666">(</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">rowVecBegin</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">rowVecEnd</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">isBoardValid</span><span style="color:#666666">)</span><span style="color:#4D9375"> break</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            cellValue </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">__normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">*</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">rowVecBegin</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">cellValue </span><span style="color:#CB7676">==</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                isBoardValid </span><span style="color:#666666">=</span><span style="color:#4D9375"> false</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">                goto</span><span style="color:#80A665"> LAB_CANARY_CHECK</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#80A665">            __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">++</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">rowVecBegin</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#80A665">        __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">++</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">boardVecBegin</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">    }</span><span style="color:#4D9375"> while</span><span style="color:#666666">(</span><span style="color:#4D9375"> true</span><span style="color:#666666"> );</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<blockquote>
<p>This function checks whether the board is valid by calling the <code>isValid(*board)</code> function, and it ensures there are no cells with a value of <code>0</code>. It provides additional information beyond what is discussed in the <code>isValid(*board)</code> description.</p>
</blockquote>
<h4 id="getflagboard"><code>getFlag(*board)</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#DBD7CAEE">vector </span><span style="color:#CB7676">*</span><span style="color:#BD976A">getFlag</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">abi:cxx11</span><span style="color:#666666">](</span><span style="color:#DBD7CAEE">vector </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">    __normal_iterator aVecIterator</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    bool</span><span style="color:#DBD7CAEE"> compareVecs</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 beginAVec_2</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    double</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">pdVar1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">vectorToMultiply</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    double</span><span style="color:#DBD7CAEE"> dVar2</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 endAVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 local_d8</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ulong aVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">local_c8</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    double</span><span style="color:#DBD7CAEE"> local_c0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#DBD7CAEE"> local_b8 </span><span style="color:#666666">[</span><span style="color:#4C9A91">32</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#DBD7CAEE"> local_98 </span><span style="color:#666666">[</span><span style="color:#4C9A91">32</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector matrixToMultiply </span><span style="color:#666666">[</span><span style="color:#4C9A91">32</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    allocator</span><span style="color:#CB7676">&#x3C;double></span><span style="color:#DBD7CAEE"> vecToAllocate </span><span style="color:#666666">[</span><span style="color:#4C9A91">32</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 beginAVec </span><span style="color:#666666">[</span><span style="color:#4C9A91">3</span><span style="color:#666666">];</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canary</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 aVecIterator_2</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ulong aVec_1</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canary </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">size</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">A</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVec </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> aVec </span><span style="color:#CB7676">>></span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double</span><span style="color:#666666">>::</span><span style="color:#80A665">allocator</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVec_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> aVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#BD976A">    beginAVec</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#666666"> =</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">A</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVecIterator_2 </span><span style="color:#666666">=</span><span style="color:#80A665"> __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">+</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">aVec_1</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    beginAVec_2 </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">A</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>(</span><span style="color:#DBD7CAEE">local_b8</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">beginAVec_2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">aVecIterator_2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double</span><span style="color:#666666">>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">allocator</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double</span><span style="color:#666666">>::</span><span style="color:#80A665">allocator</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVecIterator_2 </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">A</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVec_1 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> aVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#BD976A">    beginAVec</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]</span><span style="color:#666666"> =</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">A</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    beginAVec_2 </span><span style="color:#666666">=</span><span style="color:#80A665"> __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">+</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">aVec_1</span><span style="color:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>(</span><span style="color:#DBD7CAEE">local_98</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">beginAVec_2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">aVecIterator_2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double</span><span style="color:#666666">>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">allocator</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    matrixVectorMultiply</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">matrixToMultiply</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">vectorToMultiply</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    matrixVectorMultiply</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">vectorToMultiply</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">matrixToMultiply</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    aVecIterator_2 </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    beginAVec_2 </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    endAVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">__normal_iterator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double*</span><span style="color:#666666">>((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">local_d8</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">endAVec</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">insert</span><span style="color:#666666">&#x3C;>((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">local_d8</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">beginAVec_2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">aVecIterator_2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">string</span><span style="color:#666666">::</span><span style="color:#80A665">string</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">string </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    local_c8 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    endAVec </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">local_c8</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    local_d8 </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">local_c8</span><span style="color:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    while</span><span style="color:#666666">(</span><span style="color:#4D9375"> true</span><span style="color:#666666"> )</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        compareVecs </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> operator</span><span style="color:#CB7676">!=</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">endAVec</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">local_d8</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">compareVecs</span><span style="color:#666666">)</span><span style="color:#4D9375"> break</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">        pdVar1 </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">double</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">__normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">*</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">endAVec</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        local_c0 </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">pdVar1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">        dVar2 </span><span style="color:#666666">=</span><span style="color:#80A665"> round</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">local_c0</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">string</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">+=</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">string </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">,(</span><span style="color:#CB7676">char</span><span style="color:#666666">)(</span><span style="color:#CB7676">int</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">dVar2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">++</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">endAVec</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">beginAVec</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vecToAllocate</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">matrixToMultiply</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">local_98</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">vector</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">local_b8</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canary </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> boardPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>This function takes a two-dimensional vector (<code>A</code>) and the current state of the board to compute the flag. It divides the vector <code>A</code> into two segments and performs matrix-vector multiplications using the <code>matrixVectorMultiply(matrix, vector)</code> function on each segment. The results of these multiplications are combined, and the resulting elements are converted into characters by rounding the doubles to integers. These characters are then concatenated to form a string.</p>
<p>The resulting string corresponds to the content of the flag. This string is appended to the prefix <code>TRX{}</code> and returned as the final flag. The flag’s value depends on the final state of the board and the vector <code>A</code>.</p>
<p>The <code>getFlag()</code> function is triggered only upon a win condition. When called, it processes the board and vector <code>A</code> to construct the flag, which is then printed in the <code>play()</code> function.</p>
<h4 id="matrixvectormultiplymatrix-vector"><code>matrixVectorMultiply(*matrix, *vector)</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#80A665"> matrixVectorMultiply</span><span style="color:#666666">(</span><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">matrix</span><span style="color:#666666">,</span><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">vector</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ulong vectorSize</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">matrixRowPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">matrixCellPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    double</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">vectorCellPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">vector_2</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    allocator tempAllocator</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    double</span><span style="color:#DBD7CAEE"> zeroValue</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ulong i</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ulong j</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canary</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#DBD7CAEE"> cellValue</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    double</span><span style="color:#DBD7CAEE"> tempProdResult</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canary </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double</span><span style="color:#666666">>::</span><span style="color:#80A665">allocator</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#DBD7CAEE">    zeroValue </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0.0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vectorSize </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">size</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vector</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">vector</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">matrix</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">vectorSize</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">zeroValue</span><span style="color:#666666">,</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">tempAllocator</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">    std</span><span style="color:#666666">::</span><span style="color:#80A665">allocator</span><span style="color:#666666">&#x3C;</span><span style="color:#CB7676">double</span><span style="color:#666666">>::</span><span style="color:#CB7676">~</span><span style="color:#80A665">allocator</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">allocator</span><span style="color:#CB7676">&#x3C;double></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">tempAllocator</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    i </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    while</span><span style="color:#666666">(</span><span style="color:#4D9375">true</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        vectorSize </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">size</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vector</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vectorSize </span><span style="color:#CB7676">&#x3C;=</span><span style="color:#DBD7CAEE"> i</span><span style="color:#666666">)</span><span style="color:#4D9375"> break</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">        j </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#4D9375">        while</span><span style="color:#666666">(</span><span style="color:#4D9375"> true</span><span style="color:#666666"> )</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            vectorSize </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">size</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">vector_2</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vectorSize </span><span style="color:#CB7676">&#x3C;=</span><span style="color:#DBD7CAEE"> j</span><span style="color:#666666">)</span><span style="color:#4D9375"> break</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            matrixRowPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">vector</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            matrixCellPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">matrixRowPtr</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            cellValue </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">matrixCellPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            vectorCellPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">double</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">vector_2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">            tempProdResult </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">vectorCellPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            vectorCellPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">double</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator[]</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">matrix</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#CB7676">            *</span><span style="color:#DBD7CAEE">vectorCellPtr </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">vectorCellPtr </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> tempProdResult </span><span style="color:#CB7676">*</span><span style="color:#666666"> (</span><span style="color:#CB7676">double</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">cellValue</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            j </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> j </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#DBD7CAEE">        i </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">+</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canary </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> matrix</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>This function multiplies the board by a vector A, producing a 25-element vector of doubles. It’s used in <code>getFlag()</code> to compute the flag characters.</p>
<h4 id="displayboardboard"><code>displayBoard(*board)</code></h4>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#CB7676">void</span><span style="color:#80A665"> displayBoard</span><span style="color:#666666">(</span><span style="color:#5DA994">vector</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">boardPtr</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#CB7676">    bool</span><span style="color:#DBD7CAEE"> checkBoardEnd</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    int</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">boardCellPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    ostream </span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">boardCellValue</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> in_FS_OFFSET</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 beginBoard</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 endBoard</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 beginBoardColumn</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    undefined8 endBoardColumn</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">boardVec</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">beginBoardRow</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">boardRow</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#CB7676">    long</span><span style="color:#DBD7CAEE"> canary</span><span style="color:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">    canary </span><span style="color:#666666">=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    boardVec </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">    beginBoard </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#DBD7CAEE">boardPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">    endBoard </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">boardVec</span><span style="color:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    while</span><span style="color:#666666">(</span><span style="color:#4D9375"> true</span><span style="color:#666666"> )</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">        checkBoardEnd </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> operator</span><span style="color:#CB7676">!=</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">beginBoard</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">endBoard</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">checkBoardEnd</span><span style="color:#666666">)</span><span style="color:#4D9375"> break</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">        beginBoardRow </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">vector</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">__normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">*</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">beginBoard</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        boardRow </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> beginBoardRow</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">        beginBoardColumn </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">begin</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">beginBoardRow</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#DBD7CAEE">        endBoardColumn </span><span style="color:#666666">=</span><span style="color:#80A665"> std</span><span style="color:#666666">::</span><span style="color:#80A665">vector</span><span style="color:#666666">&#x3C;>::</span><span style="color:#80A665">end</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">boardRow</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">        while</span><span style="color:#666666">(</span><span style="color:#4D9375"> true</span><span style="color:#666666"> )</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">            checkBoardEnd </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> operator</span><span style="color:#CB7676">!=</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">beginBoardColumn</span><span style="color:#666666">,(</span><span style="color:#DBD7CAEE">__normal_iterator </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">endBoardColumn</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">!</span><span style="color:#DBD7CAEE">checkBoardEnd</span><span style="color:#666666">)</span><span style="color:#4D9375"> break</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#DBD7CAEE">            boardCellPtr </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#CB7676">int</span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#80A665">__normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">*</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">beginBoardColumn</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#666666"> (</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">boardCellPtr </span><span style="color:#CB7676">==</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">)</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">                std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">. </span><span style="color:#C98A7D77">"</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">            }</span><span style="color:#4D9375"> else</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#DBD7CAEE">                boardCellValue </span><span style="color:#666666">=</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">boardCellPtr</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">                std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">boardCellValue</span><span style="color:#666666">,</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D77"> "</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">            }</span></span>
<span class="line"><span style="color:#80A665">            __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">++</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">beginBoardColumn</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">        }</span></span>
<span class="line"><span style="color:#80A665">        std</span><span style="color:#666666">::</span><span style="color:#80A665">ostream</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">&#x3C;&#x3C;</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">ostream </span><span style="color:#CB7676">*</span><span style="color:#666666">)</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">cout</span><span style="color:#666666">,</span><span style="color:#80A665">std</span><span style="color:#666666">::</span><span style="color:#DBD7CAEE">endl</span><span style="color:#CB7676">&#x3C;></span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#80A665">        __normal_iterator</span><span style="color:#666666">&#x3C;>::</span><span style="color:#DBD7CAEE">operator</span><span style="color:#CB7676">++</span><span style="color:#666666">((</span><span style="color:#DBD7CAEE">__normal_iterator</span><span style="color:#CB7676">&#x3C;></span><span style="color:#CB7676"> *</span><span style="color:#666666">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">beginBoard</span><span style="color:#666666">);</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#666666"> (</span><span style="color:#DBD7CAEE">canary </span><span style="color:#CB7676">!=</span><span style="color:#CB7676"> *</span><span style="color:#666666">(</span><span style="color:#CB7676">long</span><span style="color:#CB7676"> *</span><span style="color:#666666">)(</span><span style="color:#DBD7CAEE">in_FS_OFFSET </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">28</span><span style="color:#666666">))</span><span style="color:#666666"> {</span></span>
<span class="line"><span style="color:#80A665">        __stack_chk_fail</span><span style="color:#666666">();</span></span>
<span class="line"><span style="color:#666666">    }</span></span>
<span class="line"><span style="color:#4D9375">    return</span><span style="color:#666666">;</span></span>
<span class="line"><span style="color:#666666">}</span></span>
<span class="line"></span></code></pre>
<p>This function shows the content of the board on screen, printing one row in each line, and separating the columns with a space and replacing a 0 with a ”.”.</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>. . . 21 . 11 . . 3 24 9 20 23 . 7 22 . 5 18 . 15 2 16 13 . </span></span>
<span class="line"><span>24 4 . 20 15 . . 5 . 16 2 25 22 . 17 6 21 . 14 . 8 10 1 19 18 </span></span>
<span class="line"><span>. . 10 . 5 . 21 19 22 . 3 13 1 16 . 15 4 7 23 24 12 . 14 . . </span></span>
<span class="line"><span>. . 13 6 12 14 4 1 . . 24 18 19 5 . . 17 . . . 7 22 . 9 21 </span></span>
<span class="line"><span>. 23 19 7 . . 6 . . 20 15 4 . 21 . . . . 16 10 24 3 . 17 5 </span></span>
<span class="line"><span>12 15 21 . . . 16 6 18 5 7 . 17 3 9 14 . 4 24 22 13 . . . . </span></span>
<span class="line"><span>14 10 11 2 24 1 25 22 20 . . 23 6 19 . 13 5 8 12 . 17 . 7 15 9 </span></span>
<span class="line"><span>. . . . 1 24 . 3 15 10 20 8 5 . 25 9 16 19 21 . 2 6 . 12 14 </span></span>
<span class="line"><span>. . 5 . 3 . 23 14 8 . . 2 15 . 12 . 7 1 17 6 22 21 4 . 19 </span></span>
<span class="line"><span>13 . . 4 20 . . . 17 . 11 16 . . 22 . 10 18 15 23 . 25 8 1 3 </span></span>
<span class="line"><span>20 25 7 22 . 23 . 10 1 . . . . 13 4 21 . 6 19 . 3 9 15 8 . </span></span>
<span class="line"><span>1 24 . . . 4 . 20 13 . 8 . 3 . 19 16 2 12 9 5 . 14 10 25 22 </span></span>
<span class="line"><span>. . . . . . . 9 24 . 25 6 . 2 16 4 8 10 . 17 18 7 21 . 1 </span></span>
<span class="line"><span>. 8 . 10 14 16 3 25 6 . . 7 18 9 11 . 13 . 20 . 19 24 5 . 17 </span></span>
<span class="line"><span>17 3 . 15 9 5 . . 11 . . 21 . . 23 7 . 22 . . 20 13 12 4 6 </span></span>
<span class="line"><span>15 . 20 11 21 10 . . 5 22 16 . . 8 3 24 . 13 2 19 . . . . . </span></span>
<span class="line"><span>. 13 8 . 19 17 . . . . . 12 7 24 6 . 15 23 22 4 14 5 9 . . </span></span>
<span class="line"><span>9 1 23 14 4 . 24 . 7 8 19 . 2 . 13 17 3 20 5 . . 15 . 16 10 </span></span>
<span class="line"><span>10 . 2 12 . 13 18 15 . . 17 5 . 20 21 8 1 16 . 7 . 19 . 11 . </span></span>
<span class="line"><span>7 5 17 24 16 20 2 11 19 3 23 . 4 15 1 18 14 . 10 . . 8 13 21 12 </span></span>
<span class="line"><span>. 20 9 . 7 15 22 17 10 . 12 19 . . 24 25 . 14 4 8 16 18 2 . . </span></span>
<span class="line"><span>19 2 24 8 . . 20 7 4 . . . 9 . 15 5 . 21 11 16 1 . . 14 25 </span></span>
<span class="line"><span>. . 25 1 . 8 5 23 14 6 4 17 16 . 2 . 20 . 13 9 10 12 24 7 15 </span></span>
<span class="line"><span>. . 14 . . . . . . 2 6 10 13 . 5 12 . 24 . . 9 11 . 3 8 </span></span>
<span class="line"><span>6 . 15 . 13 . . 24 . 9 1 . 8 25 . 10 18 17 . 2 . 4 19 . 23</span></span>
<span class="line"><span></span></span></code></pre>
<h2 id="considerations">Considerations</h2>
<p>After a first analysis of the functions, we reflected on the following points:</p>
<ol>
<li>The <code>displayBoard</code> function was not called by any other function, but could have been useful for getting the ongoing status of the board.</li>
<li>By inspecting the contents of the variables <code>board</code> and <code>A</code> (both used by <code>getFlag</code>) in Ghidra, we noticed that they were all initialized to <code>0</code>. Since the flag is computed based on both the <code>board</code> and vector <code>A</code>, and the user can only control the board’s values, vector <code>A</code> must have been initialized with non-zero values at some point.</li>
<li>The board verification mechanism resembled the logic used to validate a Sudoku puzzle.  During the first test, the board validation immediately failed after entering the number <code>1</code> in the first row and first column. Understanding how the board validation process works, one possible explanation for this behavior is that the board itself had already been initialized.</li>
</ol>
<h2 id="our-solution">Our Solution</h2>
<p>We concentrate on point 1, as it can give us more insight into the others. Among the functions, there is one that appears to initialize values, but it is quite lengthy and obscure (<code>__static_initialization_and_destruction_0(1,0xffff)</code>, called by <code>GLOBAL_sub_I_board</code>, which in turn is called by <code>__frame_dummy_init_array_entry</code>).</p>
<p>If only there were a way to debug the binary easily, either by modifying the control flow or dumping entire memory regions…</p>
<div align="center">
    <img src="/writeup_files/sudo-kurl/libdebug.png" alt="libdebug" width="60%">
</div>
<p>Here comes <a href="https://libdebug.org" style="font-family: Nunito, Sans-serif; font-weight: bold">libdebug</a> to the rescue! This library allows us to interact with the binary in a more straightforward way, by setting breakpoints, reading and writing memory, and controlling the execution flow.</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> libdebug </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> debugger</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># let's debug the chall binary...</span></span>
<span class="line"><span style="color:#DBD7CAEE">d </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> debugger</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">./chall</span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#758575DD"># ... using the pipe interaction</span></span>
<span class="line"><span style="color:#DBD7CAEE">pipe </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">run</span><span style="color:#666666">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># let's try to see whether it is possible not to call the isValid function, but the displayBoard one...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># first of all, place a hardware breakpoint in play()+38 using a binary-relative addressing</span></span>
<span class="line"><span style="color:#DBD7CAEE">bp </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">breakpoint</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"play()+</span><span style="color:#C99076">{</span><span style="color:#B8A965">str</span><span style="color:#666666">(</span><span style="color:#B8A965">hex</span><span style="color:#666666">(</span><span style="color:#4C9A91">38</span><span style="color:#666666">))</span><span style="color:#C99076">}</span><span style="color:#C98A7D">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> file</span><span style="color:#666666">=</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">binary</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> hardware</span><span style="color:#666666">=</span><span style="color:#4D9375">True</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">while</span><span style="color:#CB7676"> not</span><span style="color:#DBD7CAEE"> d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">dead</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#758575DD">    # continue the execution waiting for the breakpoint to be reached</span></span>
<span class="line"><span style="color:#DBD7CAEE">    d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">cont</span><span style="color:#666666">()</span></span>
<span class="line"><span style="color:#DBD7CAEE">    d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">wait</span><span style="color:#666666">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    if</span><span style="color:#DBD7CAEE"> bp</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">hit_on</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">threads</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">]):</span></span>
<span class="line"><span style="color:#DBD7CAEE">        d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">step</span><span style="color:#666666">()</span></span>
<span class="line"><span style="color:#B8A965">        print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Hit on play+38!</span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">        # let's change the next instruction pointer to the one of the displayBoard function...</span></span>
<span class="line"><span style="color:#DBD7CAEE">        d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">regs</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">rip </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">maps</span><span style="color:#666666">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">].</span><span style="color:#DBD7CAEE">base </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">2469</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># the board should be printed after the initial welcome message...</span></span>
<span class="line"><span style="color:#DBD7CAEE">pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">(</span><span style="color:#BD976A">numlines</span><span style="color:#666666">=</span><span style="color:#4C9A91">4</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># let's create a mono-dimensional array reading all the lines, removing useless spaces, and splitting values by ' '</span></span>
<span class="line"><span style="color:#DBD7CAEE">initial_board </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">(</span><span style="color:#4C9A91">25</span><span style="color:#666666">).</span><span style="color:#DBD7CAEE">decode</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">strip</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">split</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D77"> "</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#758575DD"># if the value is uninitialized, there is a "." we can replace with a placeholder value (e.g. 0, in our case)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">initial_board </span><span style="color:#666666">=</span><span style="color:#666666"> [</span><span style="color:#B8A965">int</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">x</span><span style="color:#666666">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> x </span><span style="color:#CB7676">!=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">.</span><span style="color:#C98A7D77">"</span><span style="color:#4D9375"> else</span><span style="color:#4C9A91"> 0</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> x </span><span style="color:#4D9375">in</span><span style="color:#DBD7CAEE"> initial_board</span><span style="color:#666666">]</span></span>
<span class="line"><span style="color:#B8A965">print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">join</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D77"> "</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">join</span><span style="color:#666666">(</span><span style="color:#B8A965">map</span><span style="color:#666666">(</span><span style="color:#B8A965">str</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> initial_board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">*</span><span style="color:#4C9A91">25</span><span style="color:#666666">:(</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">1</span><span style="color:#666666">)</span><span style="color:#CB7676">*</span><span style="color:#4C9A91">25</span><span style="color:#666666">]))</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">25</span><span style="color:#666666">)))</span></span>
<span class="line"></span></code></pre>
<p>Here is the board! And here is explained the error encountered after entering the number 1 in the first row, first column… There was already a 1 in the twelfth row, first column.</p>
<div align="center">
    <img src="/writeup_files/sudo-kurl/board.png" alt="Board">
</div>
<p>But are we sure that the values of <code>A</code> and <code>board</code> remain constant across different executions? Fortunately, yes!</p>
<p>Therefore we can rely on their consistency to solve the challenge effectively. To retrieve the flag, we just need to manipulate the board such that the matrix-vector multiplication in <code>getFlag</code> produces the desired result. This involves carefully placing values on the board while adhering to the constraints enforced by <code>isValid</code> and <code>checkWin</code>. In short, we need to solve the Sudoku puzzle…</p>
<p>This is the second part of the script. After libdebug is used to force the binary to display the board, we parse the cells and run the <a href="https://ericpony.github.io/z3py-tutorial/guide-examples.htm">Z3 solver</a> to solve the Sudoku puzzle. Once the board is solved, we send the values to the binary and retrieve the flag.</p>
<pre class="astro-code vitesse-dark" style="background-color:#121212;color:#dbd7caee; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#758575DD"># solve the sudoku using z3</span></span>
<span class="line"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> z3 </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C99076">BOARD_SIZE</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 25</span></span>
<span class="line"><span style="color:#C99076">BOARD_STEP</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">s </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> Solver</span><span style="color:#666666">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># create the board</span></span>
<span class="line"><span style="color:#DBD7CAEE">board </span><span style="color:#666666">=</span><span style="color:#666666"> [[</span><span style="color:#DBD7CAEE">Int</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"board_</span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">i</span><span style="color:#C99076">}</span><span style="color:#C98A7D">_</span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">j</span><span style="color:#C99076">}</span><span style="color:#C98A7D">"</span><span style="color:#666666">)</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">25</span><span style="color:#666666">)]</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> j </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">25</span><span style="color:#666666">)]</span></span>
<span class="line"><span style="color:#758575DD"># add constraints</span></span>
<span class="line"><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#C99076">BOARD_SIZE</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> j </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">25</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#758575DD">        # 1) all the numbers must be between 1 and 25</span></span>
<span class="line"><span style="color:#DBD7CAEE">        s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]</span><span style="color:#CB7676"> >=</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]</span><span style="color:#CB7676"> &#x3C;=</span><span style="color:#4C9A91"> 25</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#758575DD">        # 2) if the number is already given, it must be the same     </span></span>
<span class="line"><span style="color:#4D9375">        if</span><span style="color:#DBD7CAEE"> initial_board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">*</span><span style="color:#4C9A91">25</span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]</span><span style="color:#CB7676"> !=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">            s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]</span><span style="color:#CB7676"> ==</span><span style="color:#DBD7CAEE"> initial_board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">*</span><span style="color:#4C9A91">25</span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">])</span></span>
<span class="line"><span style="color:#758575DD">    # 3) all the numbers in the row must be different</span></span>
<span class="line"><span style="color:#DBD7CAEE">    s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">Distinct</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]))</span></span>
<span class="line"><span style="color:#758575DD">    # 4) all the numbers in the column must be different</span></span>
<span class="line"><span style="color:#DBD7CAEE">    s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">Distinct</span><span style="color:#666666">([</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">]</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> j </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#C99076">BOARD_SIZE</span><span style="color:#666666">)]))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># 5) all the numbers in the 5x5 blocks must be different</span></span>
<span class="line"><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#C99076"> BOARD_SIZE</span><span style="color:#666666">,</span><span style="color:#C99076"> BOARD_STEP</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> j </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#C99076"> BOARD_SIZE</span><span style="color:#666666">,</span><span style="color:#C99076"> BOARD_STEP</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#DBD7CAEE">        block </span><span style="color:#666666">=</span><span style="color:#666666"> [</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE">k</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">j</span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE">l</span><span style="color:#666666">]</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> k </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#C99076">BOARD_STEP</span><span style="color:#666666">)</span><span style="color:#4D9375"> for</span><span style="color:#DBD7CAEE"> l </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#C99076">BOARD_STEP</span><span style="color:#666666">)]</span></span>
<span class="line"><span style="color:#DBD7CAEE">        s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">add</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">Distinct</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">block</span><span style="color:#666666">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD"># check if the board is solvable</span></span>
<span class="line"><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">check</span><span style="color:#666666">()</span><span style="color:#CB7676"> ==</span><span style="color:#DBD7CAEE"> sat</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">    m </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">model</span><span style="color:#666666">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    # solve the game after having re-run the challenge...</span></span>
<span class="line"><span style="color:#DBD7CAEE">    pipe </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">run</span><span style="color:#666666">()</span></span>
<span class="line"><span style="color:#DBD7CAEE">    d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">cont</span><span style="color:#666666">()</span></span>
<span class="line"><span style="color:#DBD7CAEE">    pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">deploy.</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#C99076">BOARD_SIZE</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#4D9375">        for</span><span style="color:#DBD7CAEE"> j </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#666666">(</span><span style="color:#C99076">BOARD_SIZE</span><span style="color:#666666">):</span></span>
<span class="line"><span style="color:#758575DD">            # ...avoiding inserting yet initilized numbers </span></span>
<span class="line"><span style="color:#4D9375">            if</span><span style="color:#DBD7CAEE"> initial_board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">*</span><span style="color:#4C9A91">25</span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]</span><span style="color:#CB7676"> ==</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#DBD7CAEE">                pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">                pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"</span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">1</span><span style="color:#C99076">}</span><span style="color:#C98A7D">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">                pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">                pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"</span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">j</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">1</span><span style="color:#C99076">}</span><span style="color:#C98A7D">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">                pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">                pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#666666">(</span><span style="color:#B8A965">str</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">m</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]]))</span></span>
<span class="line"><span style="color:#B8A965">                print</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"Row </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">1</span><span style="color:#C99076">}</span><span style="color:#C98A7D"> - Col </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">j</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">1</span><span style="color:#C99076">}</span><span style="color:#C98A7D">: </span><span style="color:#C99076">{</span><span style="color:#DBD7CAEE">m</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">board</span><span style="color:#666666">[</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">][</span><span style="color:#DBD7CAEE">j</span><span style="color:#666666">]]</span><span style="color:#C99076">}</span><span style="color:#C98A7D">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    </span></span>
<span class="line"><span style="color:#DBD7CAEE">    pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"><span style="color:#DBD7CAEE">    pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#666666">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"-1"</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD">    # the flag should appear there... :D</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">decode</span><span style="color:#666666">())</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">decode</span><span style="color:#666666">())</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">decode</span><span style="color:#666666">())</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">decode</span><span style="color:#666666">())</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#DBD7CAEE">pipe</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvline</span><span style="color:#666666">().</span><span style="color:#DBD7CAEE">decode</span><span style="color:#666666">())</span></span>
<span class="line"><span style="color:#4D9375">else</span><span style="color:#666666">:</span></span>
<span class="line"><span style="color:#B8A965">    print</span><span style="color:#666666">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">No solution found</span><span style="color:#C98A7D77">"</span><span style="color:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE">d</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">kill</span><span style="color:#666666">()</span></span>
<span class="line"></span></code></pre>
<p>Flag: <code>TRX{H0w_0ft3n_d0_y0u_th1nk_4b0ut_th3_R0m4n_3mp1r3?!?:D}</code></p>  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 Tower of Hanoi. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://twitter.com/towerofhanoi" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Tower of Hanoi on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/towerofhanoi" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Tower of Haoi's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://ctftime.org/team/300" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Tower of Hanoi's CTF Time page</span> <svg viewBox="0 0 16 16" width="32" height="32" data-astro-cid-sz7xmlte> <path fill="currentColor" d="M 0,0 H 16 V 16 H 0 L 4.7205698,7.7838485 Z" data-astro-cid-sz7xmlte></path> </svg> </a> </div> </footer>  </body></html>